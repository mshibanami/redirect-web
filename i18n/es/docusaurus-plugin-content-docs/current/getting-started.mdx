# Primeros Pasos

Esta página describe casos de uso comunes para crear reglas en la aplicación Redirect Web.

(También puedes aprender los detalles de la configuración de reglas en la página [Configuración de Reglas](./rule-settings).)


## Caso 1: Abrir otro sitio web

Supón que eres adicto a Twitter y decides meditar en Insight Timer cada vez que abres Twitter accidentalmente. ¡Vamos a crear una regla para eso!

### Paso 1. Configurar "Redirigir desde"

Primero, debes configurar la sección *Redirigir desde* en la pantalla *Editar Regla* de la aplicación. Los objetivos son URLs que comienzan con `https://twitter.com/`.

En este caso, puedes especificar el siguiente patrón con el modo [Comodín](rule-settings?id=wildcard):

```
https://twitter.com/*
```

En el modo Comodín, `*` significa que coincide con cualquier cosa (= cero o más caracteres).

Sin embargo, espera. `twitter.com` fue renombrado a `x.com`. Podrías simplemente reemplazar `twitter.com` con `x.com`, pero nadie sabe cuándo el nuevo propietario cambiará de opinión de nuevo para revertirlo. Por lo tanto, apuntemos tanto a `twitter.com` como a `x.com`.

Para hacer eso, cambia de Comodín a [Expresión Regular](rule-settings?id=regular-expression), y establece esto como el patrón:

```
https://(twitter|x).com/.*
```

* `(twitter|x)`: se dirige tanto a `twitter` como a `x`. (`|` se llama *una barra vertical*.)
* `.*`: Es lo mismo que `*` de Comodín. Más específicamente, `.` significa *cualquier carácter* y `*` significa *cualquier cosa antes de este símbolo repetido cualquier número de veces*, lo que resulta en que coincide con cualquier cosa.

La Expresión Regular es un poco complicada, pero una vez que te acostumbras a ella, será una herramienta poderosa. Recomendamos usar [RegExr](https://regexr.com) como un campo de pruebas para analizar cómo funciona tu patrón de Expresión Regular.

> [!NOTE]
> En las Expresiones Regulares, `.` en `(twitter|x).com` también se trata como *cualquier carácter*. Por lo tanto, `(twitter|x).com/.*` también coincide, por ejemplo, con `twitter1com/` o `x_com/`.
>
> Para evitarlo, puedes cambiarlo a `(twitter|x)\.com/.*`. `\` se usa para escapar un carácter especial.
>
> Sin embargo, no existen tales URLs en el entorno general de Internet. Por lo tanto, puedes dejar `.` como un carácter especial si lo prefieres. Tu regla es para tu propio uso, así que impleméntala como mejor te parezca.

### Paso 2: Configurar "Redirigir a"

Simplemente especifica la URL de la siguiente manera:

```
https://insighttimer.com/saraauster/guided-meditations/calm
```

¡Ahora, Redirect Web te lleva a la meditación cuando accedes a Twitter!

**[⬇️ Descargar la Regla](/rules/reduce-twitter-addiction.redirectweb)**

## Caso 2: Eliminar Parámetros de Consulta de la URL

Supongamos que hay un parámetro de consulta `source=twitter` en una URL de `example.com`, y decides eliminarlo para anonimizarte.

En este caso, la opción **Procesamiento de Grupo de Captura** es la forma más sencilla:

* **Redirigir desde**: `https://example.com/*` (Comodín)
* **Redirigir a**: `$0`
* **Procesamiento de Grupo de Captura**:
    * **Grupo**: `$0`
    * **Proceso**: Reemplazar Ocurrencias
        * **Objetivo**: `&?source=[^&]*`
        * **Reemplazo**: *(ninguno)*
        * **Patrón de Texto**: Expresión Regular

**[⬇️ Descargar la Regla](/rules/remove-parameters.redirectweb)**

Esta regla funciona de la siguiente manera:

```
https://example.com/?source=twitter
↪ https://example.com/?

https://example.com/?hello=world&source=twitter&foo=bar
↪ https://example.com/?hello=world&foo=bar
```

Si quieres eliminar más parámetros, añade más procesos.

## Caso 3: Añadir Parámetros de Consulta a la URL

Supongamos que hay un sitio web llamado `example.com` que muestra un diseño móvil por defecto, pero prefieres su diseño de escritorio. Afortunadamente, el sitio web admite un parámetro de consulta `layout` para especificar qué diseño muestra el sitio web. Vamos a crear una regla que añada `layout=desktop` automáticamente.

Quizás pienses que podrías definirlo de la siguiente manera:

* **Redirigir desde**: `https://example.com/.*` (Expresión Regular)
* **Redirigir a**: `$0?layout=desktop`

`$0` hace referencia a la URL de destino. Si intentas acceder a `example.com/hello`, eres redirigido a `example.com/hello?layout=desktop`. Esta característica se llama *sustitución*.

> [!TIP]
> La sustitución también está disponible para el modo Comodín, ya que internamente se convierte a Expresión Regular.

Sin embargo, hay algunos problemas con estas configuraciones.

### Problema 1: Bucle infinito

La configuración actual crea un bucle de redirección infinito ya que `https://example.com/.*` también apunta a `https://example.com/hello?layout=desktop`.

En este caso, puedes especificar un patrón de URL excluido que te permita acceder sin redirección, así con Expresión Regular:

```
.*[&?]layout=[^&]*.*
```

* `.*`: Coincide con cualquier cosa
* `[&?]`: Coincide con `&` o `?`
* `[^&]*`: Coincide con cualquier cosa excepto `&`

### Problema 2: No puede manejar los parámetros existentes correctamente

Si la URL de destino ya tiene otros parámetros de consulta como `example.com/hello?theme=dark`, el destino será `example.com/hello?theme=dark?layout=desktop` (Hay dos `?` en la URL) pero solo puedes unir los parámetros con `&`. `?` como carácter especial solo se permite al principio de los parámetros. Por lo tanto, no se trata como un parámetro válido.

En este caso, cambia las configuraciones así:

* **Redirigir desde**: `(https://example.com/[^?]*)(\?(.*))?`
* **Redirigir a**: `$1?layout=desktop&$3`

Echemos un vistazo paso a paso.

* `(https://example.com/[^?]*)`: Coincide con la parte hasta el carácter anterior de `?`.
    * `[^?]*` coincide con cualquier cosa excepto `?`.
    * Esto está envuelto con `()` para que puedas referenciarlo con `$1` más tarde.
* `(\?(.*))?`: Coincide con una cadena que comienza con `?`, lo que significa parámetros de consulta.
    * Esto también coincide con una cadena vacía por el cuantificador `?` al final del patrón, que *coincide cero o una vez*.
    * Los `()` externos y los `()` internos pueden ser referenciados con `$2` y `$3` más tarde.

[RegExr](https://regexr.com) puede ayudarte a entender los detalles.

> [!NOTE]
> RegExr muestra un error cuando no se escapa `/` con `\`. Aunque puedes escaparlo, no es necesario ya que Redirect Web usa un motor diferente de Apple que no requiere el escape.

Esta no es una solución perfecta, ya que redirige `example.com/hello` a `example.com/hello?layout=desktop&`, lo que incluye un `&` innecesario al final de la URL. No es un gran problema en general, pero si deseas eliminarlo, puedes usar el *Procesamiento de Grupo de Captura*.

En conclusión, esta es la salida final:

* **Redirigir desde**: `(https://example.com/[^?]*)((\?(.*))?)` (Expresión Regular)
* **Redirigir a**: `$1?layout=desktop$3`
* **Patrón de URL Excluida**: `.*[&?]layout=[^&]*.*` (Expresión Regular)
* **Procesamiento de Grupo de Captura**:
    * **Grupo**: `$3`
    * **Proceso**: Reemplazar Ocurrencias
        * **Objetivo**: `\?(.*)`
        * **Reemplazo**: `&$1`

**[⬇️ Descargar la Regla](/rules/add-parameters.redirectweb)**

Esto es meramente un ejemplo. También puedes crear varias reglas para manejar cada problema. Puede ser mucho más simple.

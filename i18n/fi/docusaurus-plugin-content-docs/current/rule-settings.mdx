# Sääntöasetukset

Tämä sivu tarjoaa yksityiskohtaista tietoa jokaisesta asetuksesta Redirect Web -sovelluksen Muokkaa sääntöä -näytössä.

## Vaihtoehdot

### Tyyppi {#type}

Määritä **Tyyppi**-vaihtoehto hallitaksesi, miten sovellus käsittelee uudelleenohjausta. Voit valita näistä:

* **Original** (Oletus)
    * Tämä käyttää perinteisiä Web API -rajapintoja uudelleenohjauksen hallintaan. Lisäksi se käyttää [Tabs API -rajapintaa](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) vararatkaisuna.
        * Firefoxissa se käyttää [WebRequest API -rajapintaa](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) uudelleenohjauksen käsittelyyn.
    * Voit käyttää kaikkia muita vaihtoehtoja paitsi [Resurssityypit](#resource-types) ja [Pyynnön menetelmät](#request-methods).
    * Tämä on hitaampi kuin *Declarative*-tyyppi ja saattaa aiheuttaa ylimääräisiä verkkopyyntöjä.
* **DNR** (Kokeellinen Safarille):
    * Tämä tyyppi toimii paljon nopeammin kuin Original-tyyppi, koska se ei käynnistä verkkopyyntöä lähde-URL-osoitteelle.
    * Tämän avulla voit määrittää [Resurssityypit](#resource-types) ja [Pyynnön menetelmät](#request-methods).
    * ⚠️ Et voi käyttää joitakin vaihtoehtoja, kuten [Sieppausryhmän käsittely](#capturing-group-processing) ja [Poissuljetut URL-kuviot](#excluded-url-patterns), koska DNR API ei ole vielä tukenut niitä.
    * ⚠️ Safarissa et voi tällä hetkellä sisällyttää pystyviivoja (`|`) säännöllisen lausekkeen kuvioosi. [Tiedot](https://github.com/mshibanami/redirect-web/issues/44)
    * ⚠️ Koska Safarin DNR API:ssa on edelleen joitakin ongelmia, pidämme sitä edelleen kokeellisena ominaisuutena Safarille. Löydät luettelon kaikista tunnetuista ongelmista [täältä](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Uudelleenohjaa kohteesta {#redirect-from}

**Uudelleenohjaa kohteesta** -vaihtoehdon avulla voit määrittää URL-kuvion verkkosivuille, joista haluat uudelleenohjata. Voit valita joko [Wildcard](#wildcard) tai [Regular Expression](#regular-expression).

Esimerkiksi, jos määrität `https://example.com/*` Wildcardilla, se vastaa `https://example.com/` tai `https://example.com/hello`.

> [!NOTE]
> Uudelleenohjaa kohteeseen -vaihtoehdossa voit viitata koko vastaavuuteen käyttämällä `$0` tai osittaisiin vastaavuuksiin käyttämällä `$1`, `$2`, ... Tarkista yksityiskohdat [URL-kuvio](#url-pattern) -kohdasta tällä sivulla.

#### Resurssityypit {#resource-types}

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

**Resurssityypit**-vaihtoehdon avulla voit määrittää verkkopyyntöjen luokat, kuten kuvat, JavaScriptit ja tyylitiedostot, joihin sääntöä sovelletaan.
Esimerkiksi, jos asetat `script`, voit uudelleenohjata verkkosivujen lataamia JavaScript-tiedostoja.

Tällä hetkellä nämä ovat saatavilla:
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

Oletusasetus on `main_frame`, joka on välilehteen ladattu ylätason sivu.

Tarkista kunkin resurssityypin yksityiskohdat [mdn web docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType) -sivustolta.

#### Pyynnön menetelmät {#request-methods}

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

The **Request Methods** option lets you set the target HTTP methods of the source URL.

All methods are set by default.

Please check the details of each method in [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> Safarissa tämä vaihtoehto ei välttämättä ole käytettävissä, koska Applen DNR-tyypin toteutus ei näytä käsittelevän sitä tällä hetkellä. Lähetimme palautetta Applelle FB14502272-tunnuksella.

#### Kohdeselaimet {#target-browsers}

![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

**Kohdeselaimet**-vaihtoehdon avulla voit määrittää, mihin selaimeen sääntöä tulisi soveltaa tai ei tulisi soveltaa.

* Voit valita kahden tyyppisiä selaimia:
    * **Selaimet, jotka voit valita oletuksena**: Voit valita Safarin, Chromen, Firefoxin, Edgen, Operan, Arcin, Braven ja Vivaldin oletuksena. Tämä ei erottele saman selaimen variantteja, kuten Safaria ja Safari Technology Preview'ta.
    * **Käyttäjän määrittämät selaimet**: Napauttamalla Lisää-painiketta ponnahdusikkunassa voit valita minkä tahansa muun selaimen kuin Safarin tai Safari Technology Preview'n, johon Redirect Web -laajennus on asennettu.
* **Kaikki paitsi valitut** -valintaruudun avulla voit kohdistaa kaikki selaimet paitsi ne, jotka olet valinnut.

> [!WARNING]
> Redirect Web ei pysty erottamaan, onko selain **Safari** vai **Safari Technology Preview**, koska sovellus tarkistaa laajennuksen pääprosessin havaitakseen sen, mutta näillä kahdella selaimella on sama pääprosessi (`/sbin/launchd`).

### Uudelleenohjaa kohteeseen {#redirect-to}

**Uudelleenohjaa kohteeseen** -vaihtoehto määrittää kohde-URL-osoitteen, johon haluat uudelleenohjata *Uudelleenohjaa kohteesta* -vaihtoehdolla vastaavasta lähde-URL-osoitteesta. Voit myös korvata sieppausryhmät `$1`, `$2`, ... tai koko vastaavuuden `$0`. Nämä auttavat sinua määrittämään kohteen dynaamisesti. Tarkista yksityiskohdat [URL-kuvio](#url-pattern) -kohdasta tällä sivulla.

For example, if you set the following rule:

* **Uudelleenohjaa kohteesta**: `https://google.com/*` (Wildcard)
* **Uudelleenohjaa kohteeseen**: `https://apple.com/$1`

ja se vastaa `https://google.com/hello`, niin kohde-URL-osoite on `https://apple.com/hello`.

Lisäksi voit muokata tekstien `$1`, `$2`, ... ennen korvausten tekemistä. Tarkista [Sieppausryhmän käsittely](#capturing-group-processing) -osio yksityiskohdista.

> [!TIP]
> Voit määrittää mukautetun URL-skeeman sovelluksen avaamiseksi. Nämä ovat esimerkkejä sovelluksista, jotka tukevat syvälinkitystä:
>
> * Figma: `figma://file/Your_Figma_ID`
> * Firefox: `firefox://open-url?url=https://example.com/hello`
> * Google Chrome: `googlechromes://example.com`
> * Microsoft Edge: `microsoft-edge://example.com`
> * Notion: `notion://www.notion.so/Your_Note_ID`
> * Slack: `slack://open`

#### Sovellus {#application}

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue) ![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Jos haluat määrittää sovelluksen, johon haluat avata kohde-URL-osoitteen, käytä **Sovellus**-yhdistelmäruutua. Tämä on käytettävissä vain macOS:ssä.

> [!WARNING]
> Voit avata vain sovelluksen, joka tukee [App Sandboxia](https://developer.apple.com/documentation/security/app_sandbox). Varmista myös, että sovellus tukee URL-osoitteen avaamista, jonka haluat avata.

### Sieppausryhmän käsittely {#capturing-group-processing}

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

**Sieppausryhmän käsittely** -vaihtoehdon avulla voit määrittää, miten käsitellään siepattuja ryhmiä, jotka voit korvata *Uudelleenohjaa kohteeseen* -vaihtoehdossa `$1`, `$2`...

Näin sieppausryhmät tehdään:

* **Wildcard**: Tekstit, jotka vastaavat `*` ja `?`, siepataan automaattisesti.
* **Regular Expression**: Tekstit, jotka vastaavat osaa kuviosta sulkeiden `()` sisällä, siepataan.

Voit valita yhden tai useamman seuraavista prosesseista:

* **URL Encode/Decode**: Tämä soveltaa [prosenttikoodausta](https://en.wikipedia.org/wiki/Percent-encoding) tai dekoodausta sieppausryhmään. Esimerkiksi, jos koodaat `https://example.com/hello`, se muunnetaan muotoon `https%3A%2F%2Fexample.com%2Fhello`. Dekoodaus toimii päinvastoin.
* **Base64 Encode/Decode**: Tämä dekoodaa/koodaa tekstin [Base64](https://en.wikipedia.org/wiki/Base64) -muotoon. Esimerkiksi, voit koodata `hello` muotoon `aGVsbG8=`, ja dekoodata sen takaisin muotoon `hello`.
* **Replace Occurrences**: Tämä korvaa yhden tai useamman merkin ryhmässä, joka vastaa **Kohdetta**, **Korvauksella**. Esimerkiksi, jos *Ryhmä* on `hello` ja *Kohde* on `l` ja Korvaus on `y`, se muunnetaan muotoon `heyyo`.

> [!NOTE]
> Tämä on tarkoitettu kunkin sieppausryhmän käsittelyyn, eikä se vaikuta siihen, mitkä URL-osoitteet jätetään pois [Poissuljetut URL-kuviot](#excluded-url-patterns) -kohdasta. Esimerkiksi, oletetaan, että sinulla on tämä sääntö:
>
> * **Uudelleenohjaa kohteesta**: `https://example.com/(hello.*)`
> * **Sieppausryhmän käsittely**:
>     * Ryhmä: `$1`
>     * Kohde: `.*` (Regular Expression)
>     * Korvaus: `hello`
> * **Poissuljettu URL-kuvio**: `https://example.com/hello`
>
> Tässä tapauksessa `https://example.com/hello_world` ei suljeta pois, kun taas `https://example.com/hello` suljetaan pois.

### Poissuljetut URL-kuviot {#excluded-url-patterns}

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

**Poissuljetut URL-kuviot** -vaihtoehdon avulla voit määrittää URL-osoitteet, joita ei uudelleenohjata. Tämä voi olla hyödyllistä uudelleenohjaussilmukoiden välttämiseksi tai tiettyjen verkkosivuston osien poissulkemiseksi uudelleenohjauksesta.

Voit määrittää poissuljetut URL-kuviot käyttämällä joko Regular Expression- tai Wildcard-kuviotyyppejä.

### Esimerkit {#examples}

**Esimerkit**-vaihtoehdon avulla voit testata uudelleenohjaussääntöäsi antamalla esimerkkiosoitteita. Lisäämällä esimerkkiosoitteen voit tarkistaa, toimiiko sääntö odotetusti ennen sen todellista soveltamista.

### Kommentit {#comments}

**Kommentit**-vaihtoehdon avulla voit lisätä muistiinpanoja tai kommentteja uudelleenohjaussääntöösi. Tämä voi olla hyödyllistä, kun haluat pitää kirjaa siitä, miksi loit tietyn säännön, tai tarjota kontekstia muille, jotka saattavat tarkastella sääntöjäsi.

## URL-kuvio {#url-pattern}

On 3 vaihtoehtoa, joissa voit määrittää yhden tai useamman URL-kuvion. *Uudelleenohjaa kohteesta*, *Poissuljetut URL-kuviot* ja *Sieppausryhmän käsittely*. Niiden määrittämiseksi voit valita joko **Wildcard** tai **Regular Expression**.

### Wildcard {#url-pattern-wildcard}

**Wildcard** on yksinkertaisempi kuviotyyppi, jonka avulla voit käyttää `*` (vastaa mitä tahansa) ja `?` (vastaa mitä tahansa yksittäistä merkkiä) jokerimerkkeinä. Tässä muutamia esimerkkejä:

* Vastaamaan `https://example.com/hello`, voit käyttää `https://example.com/*`. Tämä vastaa mitä tahansa merkkijonoa `https://example.com/` jälkeen.
* Vastaamaan `https://example.com/search?q=hello`, voit käyttää `https://example.com/search?q=*`. Tämä vastaa mitä tahansa arvoa `q`-parametrille.
* Vastaamaan mitä tahansa URL-osoitetta, joka sisältää sanan `blog`, voit käyttää `*blog*`.

Voit käyttää myös korvausta Wildcardissa, mikä tarkoittaa, että voit viitata vastaavan URL-osoitteen osiin käyttämällä `$1`, `$2` jne. Esimerkiksi, jos käytät `https://example.com/*-world-*`, ja URL-osoite on `https://example.com/hello-world-goodbye`, niin `$1` olisi "hello" ja `$2` olisi "goodbye". `$0` on myös käytettävissä viittaamaan koko vastaavaan URL-osoitteeseen.

> [!NOTE]
> Vaikka korvaus on Regular Expressionin ominaisuus, voit käyttää sitä myös Wildcardissa, koska Redirect Web muuntaa Wildcardin sisäisesti Regular Expressioniksi.

### Regular Expression {#url-pattern-regular-expression}

**Regular Expression** (Regex) on tehokas työkalu tekstin kuvioiden vastaavuuksien etsimiseen, ja se perustuu Applen säännöllisten lausekkeiden moottoriin, joka on kuvattu [täällä](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042). Sen avulla voit määrittää tietyn kuvion, joka vastaa merkkijonojoukkoa. Tässä muutamia esimerkkejä.

- Vastaamaan `https://example.com/hello`, voit käyttää `https://example.com/(.*)`. Tämä vastaa mitä tahansa merkkijonoa `https://example.com/` jälkeen ja tallentaa sen sieppausryhmään.
- Vastaamaan `https://example.com/search?q=hello`, voit käyttää `https://example.com/search\?q=(.*)`. Tämä vastaa `q`-parametrin arvoa ja tallentaa sen sieppausryhmään.
- Vastaamaan mitä tahansa URL-osoitetta, joka sisältää sanan `blog`, voit käyttää `.*blog.*`.

Voit viitata sieppausryhmiin *Uudelleenohjaa kohteeseen* tai *Korvaus*-kohdassa käyttämällä `$1`, `$2`, ... tai `$0` viitataksesi koko vastaavuuteen.

Lisätietoja Regex-syntaksista löytyy resursseista, kuten [RegExr](https://regexr.com/).

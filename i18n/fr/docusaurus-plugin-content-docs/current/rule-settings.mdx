# Paramètres de la Règle

Cette page fournit des informations détaillées sur chaque paramètre de l'écran "Modifier la Règle" dans l'application Redirect Web.

## Options

### Type {#type}

Spécifiez l'option **Type** pour contrôler la manière dont l'application gère la redirection. Vous pouvez choisir parmi les options suivantes :

*   **Original** (Par défaut)
    *   Ceci utilise les API Web traditionnelles pour contrôler la redirection. De plus, il utilise [l'API Tabs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) comme solution de repli.
        *   Dans Firefox, il utilise l'[API WebRequest](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) pour gérer la redirection.
    *   Vous pouvez utiliser toutes les options à l'exception des [Types de Ressource](#resource-types) et des [Méthodes de Requête](#request-methods).
    *   Ceci est plus lent que le type *Déclaratif* et peut entraîner des requêtes réseau supplémentaires.
*   **DNR** (Expérimental pour Safari) :
    *   Ce type fonctionne beaucoup plus rapidement que le type Original car il n'initie pas de requête réseau pour l'URL source.
    *   Cela vous permet de spécifier les [Types de Ressource](#resource-types) et les [Méthodes de Requête](#request-methods).
    *   ⚠️ Vous ne pouvez pas utiliser certaines options, telles que le [Traitement des Groupes de Capture](#capturing-group-processing) et les [Modèles d'URL Exclus](#excluded-url-patterns), car elles ne sont pas encore prises en charge par l'API DNR.
    *   ⚠️ Dans Safari, vous ne pouvez actuellement pas inclure de barres verticales (`|`) dans votre modèle d'expression régulière. [Détails](https://github.com/mshibanami/redirect-web/issues/44)
    *   ⚠️ Étant donné que l'API DNR de Safari présente encore quelques problèmes, nous considérons qu'il s'agit toujours d'une fonctionnalité expérimentale pour Safari. Vous pouvez trouver la liste de tous les problèmes connus [ici](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Rediriger depuis {#redirect-from}

L'option **Rediriger depuis** vous permet de spécifier un modèle d'URL de pages web à partir desquelles vous souhaitez rediriger. Vous pouvez choisir entre [Joker](#wildcard) ou [Expression Régulière](#regular-expression).

Par exemple, si vous spécifiez `https://example.com/*` avec Joker, cela correspondra à `https://example.com/` ou `https://example.com/hello`.

> [!NOTE]
> Dans l'option Rediriger vers, vous pouvez référencer la correspondance entière en utilisant `$0` ou des correspondances partielles en utilisant `$1`, `$2`, ... Consultez les détails dans [Modèle d'URL](#url-pattern) sur cette page.

#### Types de Ressource {#resource-types}

![Types pris en charge : DNR](https://img.shields.io/badge/Types-DNR-blue)

L'option **Types de Ressource** vous permet de spécifier les catégories de requêtes web, telles que les images, les JavaScripts et les feuilles de style, auxquelles la règle s'applique.
Par exemple, si vous définissez `script`, vous pouvez rediriger les fichiers JavaScript chargés par les pages web.

Actuellement, les options suivantes sont disponibles :
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

Le paramètre par défaut est `main_frame`, qui est la page de niveau supérieur chargée dans un onglet.

Veuillez consulter les détails de chaque type de ressource dans les [documents web mdn](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType).

#### Méthodes de Requête {#request-methods}

![Types pris en charge : DNR](https://img.shields.io/badge/Types-DNR-blue)

L'option **Méthodes de Requête** vous permet de définir les méthodes HTTP cibles de l'URL source.

Toutes les méthodes sont définies par défaut.

Veuillez consulter les détails de chaque méthode dans les [documents web mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> Dans Safari, cette option peut ne pas être disponible car l'implémentation d'Apple pour le type DNR ne semble pas la gérer actuellement. Nous avons envoyé des commentaires à Apple sous le numéro FB14502272.

#### Navigateurs Cibles {#target-browsers}

![Plateformes prises en charge : macOS](https://img.shields.io/badge/Platforms-macOS-white)

L'option **Navigateurs Cibles** vous permet de spécifier à quels navigateurs la règle doit ou ne doit pas être appliquée.

*   Il existe 2 types de navigateurs que vous pouvez choisir :
    *   **Navigateurs que vous pouvez choisir par défaut** : Vous pouvez choisir Safari, Chrome, Firefox, Edge, Opera, Arc, Brave et Vivaldi par défaut. Cela ne différencie pas les variantes du même navigateur, comme Safari et Safari Technology Preview.
    *   **Navigateurs spécifiés par l'utilisateur** : En appuyant sur le bouton Ajouter dans le popover, vous pouvez sélectionner n'importe quel navigateur autre que Safari ou Safari Technology Preview qui a l'extension Redirect Web installée.
*   La case à cocher **Tous sauf ceux sélectionnés** vous permet de cibler tous les navigateurs à l'exception de ceux que vous avez choisis.

> [!WARNING]
> Redirect Web ne peut pas différencier si le navigateur est **Safari** ou **Safari Technology Preview** car l'application vérifie le processus parent de l'extension pour le détecter, mais ces deux navigateurs partagent le même processus parent (`/sbin/launchd`).

### Rediriger vers {#redirect-to}

L'option **Rediriger vers** spécifie une URL de destination vers laquelle vous souhaitez rediriger, à partir de l'URL source correspondant à l'option *Rediriger depuis*. Vous pouvez également substituer des groupes de capture avec `$1`, `$2`, ... ou la correspondance entière avec `$0`. Ceux-ci vous aident à spécifier dynamiquement la destination. Consultez les détails dans [Modèle d'URL](#url-pattern) sur cette page.

Par exemple, si vous définissez la règle suivante :

*   **Rediriger depuis** : `https://google.com/*` (Joker)
*   **Rediriger vers** : `https://apple.com/$1`

et qu'elle correspond à `https://google.com/hello`, alors l'URL de destination sera `https://apple.com/hello`.

De plus, vous pouvez modifier les textes de `$1`, `$2`, ... avant d'effectuer les substitutions. Consultez la section [Traitement des Groupes de Capture](#capturing-group-processing) pour les détails.

> [!TIP]
> Vous pouvez spécifier un schéma d'URL personnalisé pour ouvrir une application. Voici des exemples d'applications qui prennent en charge le "deep linking" :
>
> *   Figma : `figma://file/Votre_ID_Figma`
> *   Firefox : `firefox://open-url?url=https://example.com/hello`
> *   Google Chrome : `googlechromes://example.com`
> *   Microsoft Edge : `microsoft-edge://example.com`
> *   Notion : `notion://www.notion.so/Votre_ID_Note`
> *   Slack : `slack://open`

#### Application {#application}

![Types pris en charge : Original](https://img.shields.io/badge/Types-Original-blue) ![Plateformes prises en charge : macOS](https://img.shields.io/badge/Platforms-macOS-white)

Si vous souhaitez spécifier une application avec laquelle vous souhaitez ouvrir l'URL de destination, utilisez la boîte combinée **Application**. Ceci n'est disponible que sur macOS.

> [!WARNING]
> Vous ne pouvez ouvrir qu'une application qui prend en charge le [bac à sable d'application (App Sandbox)](https://developer.apple.com/documentation/security/app_sandbox). Assurez-vous également que l'application prend en charge l'ouverture de l'URL que vous souhaitez ouvrir.

### Traitement des Groupes de Capture {#capturing-group-processing}

![Types pris en charge : Original](https://img.shields.io/badge/Types-Original-blue)

L'option **Traitement des Groupes de Capture** vous permet de spécifier comment traiter les groupes capturés que vous pouvez substituer dans l'option *Rediriger vers* avec `$1`, `$2`...

Voici comment créer des groupes de capture :

*   **Joker** : Les textes correspondant à `*` et `?` sont automatiquement capturés.
*   **Expression Régulière** : Les textes correspondant à une partie du modèle entre `()` sont capturés.

Vous pouvez choisir un ou plusieurs des processus suivants :

*   **Encodage/Décodage URL** : Ceci applique l'[encodage en pourcentage](https://en.wikipedia.org/wiki/Percent-encoding) ou le décodage à un groupe de capture. Par exemple, si vous encodez `https://example.com/hello`, il est converti en `https%3A%2F%2Fexample.com%2Fhello`. Le décodage fonctionne de manière inverse.
*   **Encodage/Décodage Base64** : Ceci décode/encode un texte en [Base64](https://en.wikipedia.org/wiki/Base64). Par exemple, vous pouvez encoder `hello` en `aGVsbG8=`, et le décoder en `hello`.
*   **Remplacer les Occurrences** : Ceci remplace un ou plusieurs caractères dans un groupe, correspondant à une **Cible**, par un **Remplacement**. Par exemple, si le *Groupe* est `hello` et la *Cible* est `l` et le Remplacement est `y`, il est modifié en `heyyo`.

> [!NOTE]
> Ceci est destiné au traitement de chaque groupe de capture et n'affecte pas les URL exclues par les [Modèles d'URL Exclus](#excluded-url-patterns). Par exemple, supposons que vous ayez cette règle :
>
> *   **Rediriger depuis** : `https://example.com/(hello.*)`
> *   **Traitement des Groupes de Capture** :
>     *   Groupe : `$1`
>     *   Cible : `.*` (Expression Régulière)
>     *   Remplacement : `hello`
> *   **Modèle d'URL Exclu** : `https://example.com/hello`
>
> Dans ce cas, `https://example.com/hello_world` ne sera pas exclu tandis que `https://example.com/hello` sera exclu.

### Modèles d'URL Exclus {#excluded-url-patterns}

![Types pris en charge : Original](https://img.shields.io/badge/Types-Original-blue)

L'option **Modèles d'URL Exclus** vous permet de spécifier les URL qui ne sont pas redirigées. Cela peut être utile pour éviter les boucles de redirection ou pour exclure certaines parties d'un site web d'être redirigées.

Vous pouvez spécifier des modèles d'URL exclus en utilisant des types de modèles d'Expression Régulière ou de Joker.

### Exemples {#examples}

L'option **Exemples** vous permet de tester votre règle de redirection en fournissant des URL d'échantillon. En ajoutant une URL d'échantillon, vous pouvez vérifier si la règle fonctionne comme prévu avant de l'appliquer réellement.

### Commentaires {#comments}

L'option **Commentaires** vous permet d'ajouter des notes ou des commentaires sur votre règle de redirection. Cela peut être utile pour garder une trace de la raison pour laquelle vous avez créé une règle spécifique ou pour fournir un contexte à d'autres personnes qui pourraient consulter vos règles.

Vous pouvez écrire des commentaires dans les formats suivants :

*   **Texte Brut** (Par défaut) : Texte simple sans aucune mise en forme.
*   **Markdown** : Vous pouvez utiliser les [syntaxes Markdown de GitHub](https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax), y compris certaines extensions que GFM ne prend pas en charge. Par exemple, vous pouvez créer des titres, des listes, des liens, et plus encore.
*   **AsciiDoc** : Vous pouvez utiliser les [syntaxes AsciiDoc](https://asciidoc.org/) pour formater vos commentaires.

## Modèle d'URL {#url-pattern}

Les **modèles d'URL** sont utilisés pour faire correspondre les URL dans les options *Rediriger depuis*, *Modèles d'URL Exclus* et *Traitement des Groupes de Capture*. Pour les spécifier, vous pouvez choisir entre **Joker** ou **Expression Régulière**.

### Joker {#url-pattern-wildcard}

Le **Joker** est un type de modèle plus simple qui vous permet d'utiliser `*` (correspond à n'importe quoi) et `?` (correspond à n'importe quel caractère unique) comme jokers. Voici quelques exemples :

*   Pour correspondre à `https://example.com/hello`, vous pouvez utiliser `https://example.com/*`. Cela correspondra à n'importe quelle chaîne après `https://example.com/`.
*   Pour correspondre à `https://example.com/search?q=hello`, vous pouvez utiliser `https://example.com/search?q=*`. Cela correspondra à n'importe quelle valeur pour le paramètre `q`.
*   Pour correspondre à n'importe quelle URL contenant le mot `blog`, vous pouvez utiliser `*blog*`.

Vous pouvez également utiliser la substitution avec le Joker, ce qui signifie que vous pouvez référencer des portions de l'URL correspondante en utilisant `$1`, `$2`, etc. Par exemple, si vous utilisez `https://example.com/*-world-*`, et que l'URL est `https://example.com/hello-world-goodbye`, alors `$1` serait "hello" et `$2` serait "goodbye". `$0` est également disponible pour référencer l'URL entière correspondante.

> [!NOTE]
> Bien que la substitution soit une fonctionnalité de l'Expression Régulière, vous pouvez également l'utiliser pour le Joker car Redirect Web convertit en interne le Joker en Expression Régulière.

### Expression Régulière {#url-pattern-regular-expression}

L'**Expression Régulière** (Regex) est un outil puissant pour faire correspondre des modèles dans le texte et est également largement utilisée en programmation. Elle vous permet de définir un modèle spécifique qui correspond à un ensemble de chaînes. Voici quelques exemples.

*   Pour correspondre à `https://example.com/hello`, vous pouvez utiliser `https://example.com/.*`. Cela correspondra à n'importe quelle chaîne après `https://example.com/`.
*   Pour correspondre à `https://example.com/search?q=hello`, vous pouvez utiliser `https://example.com/search\?q=(.*)`. Cela correspondra à la valeur du paramètre `q` et la stockera dans un groupe de capture. Vous pourrez ensuite la référencer en utilisant `$1` dans l'option *Rediriger vers*.
*   Pour correspondre à n'importe quelle URL contenant le mot `blog`, vous pouvez utiliser `.*blog.*`.

Vous pouvez référencer les groupes de capture dans *Rediriger vers* ou *Remplacement* en utilisant `$1`, `$2`, ... ou `$0` pour référencer la correspondance entière.

Redirect Web est alimenté par le [moteur Regex d'Apple](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042).

Plus d'informations sur la syntaxe Regex peuvent être trouvées dans des ressources comme [RegExr](https://regexr.com/).
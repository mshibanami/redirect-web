# Első lépések

Ez az oldal a Redirect Web alkalmazás szabályok létrehozására vonatkozó gyakori használati eseteket írja le.

(A szabálybeállítások részleteit a [Szabálybeállítások](./rule-settings) oldalon is megismerheti.)

## 1. eset: Egy másik webhely megnyitása

Tegyük fel, hogy Twitter-függő vagy, és úgy döntesz, hogy meditálsz az Insight Timerben, valahányszor véletlenül megnyitod a Twittert. Hozzunk létre erre egy szabályt!

### 1. lépés: A „Redirect From” beállítása

Először be kell állítania a *Redirect From* szekciót az alkalmazás *Szabály szerkesztése* képernyőjén. A célpontok az `https://twitter.com/` kezdetű URL-ek.

Ebben az esetben a következő mintát adhatja meg a [Joker karakter](rule-settings?id=wildcard) (Wildcard) móddal:

```
https://twitter.com/*
```

A Joker karakter (Wildcard) módban a `*` azt jelenti, hogy bármire illeszkedik (= nulla vagy több karakter).

Azonban várjunk! A `twitter.com` átnevezésre került `x.com` névre. Egyszerűen lecserélheti a `twitter.com` címet `x.com`-ra, de senki sem tudja, mikor gondolja meg magát az új tulajdonos, és állítja vissza. Ezért célozzuk meg mindkét `twitter.com` és `x.com` címet.

Ehhez váltson át a Joker karakter (Wildcard) módról a [Reguláris kifejezés](rule-settings?id=regular-expression) (Regular Expression) módra, és állítsa be ezt a mintát:

```
https://(twitter|x).com/.*
```

* `(twitter|x)`: mind a `twitter`, mind az `x` célzására szolgál. (`|` neve *pipe*.)
* `.*`: Ugyanaz, mint a Joker karakter (Wildcard) `*`-a. Pontosabban, a `.` bármely karaktert jelent, a `*` pedig azt jelenti, hogy *bármi e szimbólum előtt bármennyiszer ismétlődik*, ami azt eredményezi, hogy bármire illeszkedik.

A reguláris kifejezés kissé bonyolult, de ha megszokja, hatékony eszköz lesz. Javasoljuk, hogy használja a [RegExr](https://regexr.com) webhelyet játszótérként a reguláris kifejezés mintájának működésének elemzéséhez.

> [!NOTE]
> A reguláris kifejezésekben a `.` az `(twitter|x).com` kifejezésben is *bármely karakterként* értelmeződik. Ezért az `(twitter|x).com/.*` illeszkedik például a `twitter1com/` vagy az `x_com/` kifejezésekre is.
>
> Ennek elkerülése érdekében módosíthatja `(twitter|x)\.com/.*` alakra. A `\` egy speciális karakter kivédésére szolgál.
>
> Azonban az általános internetes környezetben nincsenek ilyen URL-ek. Ezért hagyhatja a `.` karaktert speciális karakterként, ha úgy jobban tetszik. Az Ön szabálya az Ön saját használatára szolgál, ezért úgy valósítsa meg, ahogy Ön jónak látja.

### 2. lépés: A „Redirect To” beállítása

Egyszerűen adja meg az URL-t a következőképpen:

```
https://insighttimer.com/saraauster/guided-meditations/calm
```

Mostantól a Redirect Web elviszi Önt a meditációra, amikor belép a Twitterre!

**[⬇️ Szabály letöltése](/rules/reduce-twitter-addiction.redirectweb)**

## 2. eset: Lekérdezési paraméterek eltávolítása az URL-ből

Tegyük fel, hogy az `example.com` URL-ben van egy `source=twitter` lekérdezési paraméter, és Ön úgy döntött, hogy eltávolítja azt, hogy anonimizálja magát.

Ebben az esetben a **Rögzítőcsoport-feldolgozás** (Capturing Group Processing) opció a legegyszerűbb módja:

* **Redirect From**: `https://example.com/*` (Joker karakter (Wildcard))
* **Redirect To**: `$0`
* **Rögzítőcsoport-feldolgozás** (Capturing Group Processing):
    * **Csoport** (Group): `$0`
    * **Folyamat** (Process): Előfordulások cseréje
        * **Cél** (Target): `&?source=[^&]*`
        * **Csere** (Replacement): *(nincs)*
        * **Szövegminta** (Text Pattern): Reguláris kifejezés

**[⬇️ Szabály letöltése](/rules/remove-parameters.redirectweb)**

Ez a szabály a következőképpen működik:

```
https://example.com/?source=twitter
↪ https://example.com/?

https://example.com/?hello=world&source=twitter&foo=bar
↪ https://example.com/?hello=world&foo=bar
```

Ha több paramétert szeretne eltávolítani, adjon hozzá további folyamatokat.

## 3. eset: Lekérdezési paraméterek hozzáadása az URL-hez

Tegyük fel, hogy van egy `example.com` nevű weboldal, amely alapértelmezetten mobilos elrendezést jelenít meg, de Ön a asztali elrendezést preferálja. Szerencsére a weboldal támogatja a `layout` lekérdezési paramétert, amellyel megadható, hogy a weboldal melyik elrendezést jelenítse meg. Hozzunk létre egy szabályt, amely automatikusan hozzáadja a `layout=desktop` paramétert.

Talán azt gondolja, hogy a következőképpen definiálhatja:

* **Redirect From**: `https://example.com/.*` (Reguláris kifejezés (Regular Expression))
* **Redirect To**: `$0?layout=desktop`

A `$0` a cél URL-re hivatkozik. Ha megpróbálja elérni az `example.com/hello` címet, akkor az `example.com/hello?layout=desktop` címre lesz átirányítva. Ezt a funkciót *helyettesítésnek* nevezzük.

> [!TIP]
> A helyettesítés a Joker karakter (Wildcard) módban is elérhető, mivel belsőleg reguláris kifejezéssé konvertálódik.

Azonban van néhány probléma ezekkel a beállításokkal.

### 1. probléma: Végtelen ciklus

A jelenlegi beállítás végtelen átirányítási hurkot hoz létre, mivel az `https://example.com/.*` az `https://example.com/hello?layout=desktop` címet is megcélozza.

Ebben az esetben megadhat egy kizárt URL-mintát, amely lehetővé teszi az átirányítás nélküli hozzáférést, mint például ez a reguláris kifejezés:

```
.*[&?]layout=[^&]*.*
```

* `.*`: Bármire illeszkedik
* `[&?]`: Illeszkedik `&` vagy `?` karakterre
* `[^&]*`: Bármire illeszkedik, kivéve az `&` karaktert

### 2. probléma: Nem tudja megfelelően kezelni a meglévő paramétereket

Ha a cél URL már tartalmaz más lekérdezési paramétereket, mint például `example.com/hello?theme=dark`, akkor a cél az `example.com/hello?theme=dark?layout=desktop` lesz (két `?` van az URL-ben), de a paramétereket csak `&` jellel lehet összekapcsolni. A `?` mint speciális karakter csak a paraméterek elején engedélyezett. Tehát nem érvényes paraméterként kezelődik.

Ebben az esetben módosítsa a beállításokat a következőképpen:

* **Redirect From**: `(https://example.com/[^?]*)(\?(.*))?`
* **Redirect To**: `$1?layout=desktop&$3`

Nézzük meg lépésről lépésre.

* `(https://example.com/[^?]*)`: Illeszkedik arra a részre, ami a `?` karakter előtti rész.
    * A `[^?]*` illeszkedik bármire, kivéve a `?` karaktert.
    * Ez `()`-be van zárva, így később `$1`-gyel hivatkozhat rá.
* `(\?(.*))?`: Illeszkedik egy `?` jellel kezdődő sztringre, ami lekérdezési paramétereket jelent.
    * Ez illeszkedik üres sztringre is a minta végén lévő `?` kvantor (mennyiségi jelölő) miatt, ami *nulla vagy egy alkalommal* illeszkedik.
    * A külső `()` és a belső `()` később `$2`-vel és `$3`-mal hivatkozható.

A [RegExr](https://regexr.com) segíthet a részletek megértésében.

> [!NOTE]
> A RegExr hibát jelez, ha nem védi ki a `/` karaktert `\`-vel. Bár kivédheti, nem kötelező, mivel a Redirect Web egy másik, Apple által fejlesztett motort használ, amely nem igényli a kimentést.

Ez nem tökéletes megoldás, mivel az `example.com/hello` címet átirányítja az `example.com/hello?layout=desktop&` címre, amely tartalmaz egy felesleges `&` karaktert az URL végén. Ez általában nem nagy ügy, de ha el szeretné távolítani, használhatja a *Rögzítőcsoport-feldolgozást* (Capturing Group Processing).

Összefoglalva, ez a végső kimenet:

* **Redirect From**: `(https://example.com/[^?]*)((\?(.*))?)` (Reguláris kifejezés (Regular Expression))
* **Redirect To**: `$1?layout=desktop$3`
* **Kizárt URL-minta** (Excluded URL Pattern): `.*[&?]layout=[^&]*.*` (Reguláris kifejezés (Regular Expression))
* **Rögzítőcsoport-feldolgozás** (Capturing Group Processing):
    * **Csoport** (Group): `$3`
    * **Folyamat** (Process): Előfordulások cseréje
        * **Cél** (Target): `\?(.*)`
        * **Csere** (Replacement): `&$1`

**[⬇️ Szabály letöltése](/rules/add-parameters.redirectweb)**

Ez csupán egy példa. Több szabályt is létrehozhat az egyes problémák kezelésére. Ez sokkal egyszerűbb is lehet.

# Impostazioni regole

Questa pagina fornisce informazioni dettagliate su ogni impostazione nella schermata Modifica regola dell'app Web Redirect.

## Opzioni

### Tipo

Specifica l'opzione **Tipo** per controllare come l'app gestisce il reindirizzamento. Puoi scegliere tra queste:

*   **Originale** (Predefinito)
    *   Utilizza le API Web tradizionali per controllare il reindirizzamento. Inoltre, utilizza [l'API Tabs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) come fallback.
        *   In Firefox, utilizza la [WebRequest API](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) per gestire il reindirizzamento.
    *   Puoi utilizzare tutte le opzioni tranne [Tipi di risorsa](#resource-types) e [Metodi di richiesta](#request-methods).
    *   Questo tipo è più lento del tipo *Dichiarativo* e potrebbe causare richieste di rete extra.
*   **DNR** (Sperimentale per Safari):
    *   Questo tipo funziona molto più velocemente del tipo Originale perché non avvia una richiesta di rete per l'URL di origine.
    *   Consente di specificare [Tipi di risorsa](#resource-types) e [Metodi di richiesta](#request-methods).
    *   ⚠️ Non puoi usare alcune opzioni, come [Elaborazione gruppo di cattura](#capturing-group-processing) e [Pattern URL esclusi](#excluded-url-patterns) poiché non sono ancora supportate dall'API DNR.
    *   ⚠️ In Safari, attualmente non puoi includere pipe (`|`) nel tuo pattern di Espressione Regolare. [Dettagli](https://github.com/mshibanami/redirect-web/issues/44)
    *   ⚠️ Poiché l'API DNR di Safari presenta ancora alcuni problemi, la consideriamo ancora una funzionalità sperimentale per Safari. Puoi trovare l'elenco di tutti i problemi noti [qui](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Reindirizza da

L'opzione **Reindirizza da** consente di specificare un pattern URL delle pagine web da cui si desidera reindirizzare. Puoi scegliere tra [Wildcard](#wildcard) o [Espressione regolare](#regular-expression).

Ad esempio, se specifichi `https://example.com/*` con Wildcard, corrisponderà a `https://example.com/` o `https://example.com/hello`.

> [!NOTE]
> Nell'opzione Reindirizza a, puoi fare riferimento all'intera corrispondenza usando `$0` o corrispondenze parziali usando `$1`, `$2`, ... Controlla i dettagli in [Pattern URL](#url-pattern) in questa pagina.

#### Tipi di risorsa

![Tipi supportati: DNR](https://img.shields.io/badge/Types-DNR-blue)

L'opzione **Tipi di risorsa** consente di specificare le categorie di richieste web, come immagini, JavaScript e fogli di stile, a cui si applica la regola.
Ad esempio, se imposti `script`, puoi reindirizzare i file JavaScript caricati dalle pagine web.

Attualmente, sono disponibili i seguenti:
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

L'impostazione predefinita è `main_frame`, che è la pagina di primo livello caricata in una scheda.

Verifica i dettagli di ogni tipo di risorsa nelle [documentazioni web mdn](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType).

#### Metodi di richiesta

![Tipi supportati: DNR](https://img.shields.io/badge/Types-DNR-blue)

L'opzione **Metodi di richiesta** consente di impostare i metodi HTTP di destinazione dell'URL di origine.

Tutti i metodi sono impostati per impostazione predefinita.

Verifica i dettagli di ogni metodo nelle [documentazioni web mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> In Safari, questa opzione potrebbe non essere disponibile perché l'implementazione di Apple per il tipo DNR non sembra gestirla attualmente. Abbiamo inviato un feedback ad Apple come FB14502272.

#### Browser di destinazione

![Piattaforme supportate: macOS](https://img.shields.io/badge/Platforms-macOS-white)

L'opzione **Browser di destinazione** consente di specificare a quale browser la regola debba o non debba essere applicata.

*   Ci sono 2 tipi di browser che puoi scegliere:
    *   **Browser che puoi scegliere per impostazione predefinita**: Puoi scegliere Safari, Chrome, Firefox, Edge, Opera, Arc, Brave e Vivaldi per impostazione predefinita. Questo non differenzia le varianti dello stesso browser, come Safari e Safari Technology Preview.
    *   **Browser specificati dall'utente**: Toccando il pulsante Aggiungi sul popover, puoi selezionare qualsiasi browser diverso da Safari o Safari Technology Preview che abbia l'estensione Redirect Web installata.
*   La casella di controllo **Tutti tranne quelli selezionati** ti consente di scegliere come target tutti i browser eccetto quelli che hai selezionato.

> [!WARNING]
> Redirect Web non può distinguere se il browser è **Safari** o **Safari Technology Preview** perché l'app controlla il processo genitore dell'estensione per rilevarlo, ma questi due browser condividono lo stesso processo genitore (`/sbin/launchd`).

### Reindirizza a

L'opzione **Reindirizza a** specifica un URL di destinazione a cui desideri reindirizzare, dall'URL di origine corrispondente all'opzione *Reindirizza da*. Puoi anche sostituire i gruppi di cattura con `$1`, `$2`, ... o l'intera corrispondenza con `$0`. Questi ti aiutano a specificare dinamicamente la destinazione. Controlla i dettagli in [Pattern URL](#url-pattern) in questa pagina.

Ad esempio, se imposti la seguente regola:

*   **Reindirizza da**: `https://google.com/*` (Wildcard)
*   **Reindirizza a**: `https://apple.com/$1`

e corrisponde a `https://google.com/hello`, allora l'URL di destinazione sarà `https://apple.com/hello`.

Inoltre, puoi modificare i testi di `$1`, `$2`, ... prima di effettuare le sostituzioni. Controlla la sezione [Elaborazione gruppo di cattura](#capturing-group-processing) per i dettagli.

> [!TIP]
> Puoi specificare uno schema URL personalizzato per aprire un'app. Questi sono esempi di app che supportano il deep linking:
>
> *   Figma: `figma://file/Your_Figma_ID`
> *   Firefox: `firefox://open-url?url=https://example.com/hello`
> *   Google Chrome: `googlechromes://example.com`
> *   Microsoft Edge: `microsoft-edge://example.com`
> *   Notion: `notion://www.notion.so/Your_Note_ID`
> *   Slack: `slack://open`

#### Applicazione

![Tipi supportati: Originale](https://img.shields.io/badge/Types-Original-blue) ![Piattaforme supportate: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Se desideri specificare un'app con cui aprire l'URL di destinazione, usa la casella combinata **Applicazione**. Questa opzione è disponibile solo su macOS.

> [!WARNING]
> Puoi aprire solo un'app che supporta [App Sandbox](https://developer.apple.com/documentation/security/app_sandbox). Inoltre, assicurati che l'app supporti l'apertura dell'URL che desideri aprire.

### Elaborazione gruppo di cattura

![Tipi supportati: Originale](https://img.shields.io/badge/Types-Original-blue)

L'opzione **Elaborazione gruppo di cattura** consente di specificare come elaborare i gruppi catturati che puoi sostituire nell'opzione *Reindirizza a* con `$1`, `$2`...

Ecco come creare gruppi di cattura:

*   **Wildcard**: I testi corrispondenti a `*` e `?` vengono automaticamente catturati.
*   **Espressione regolare**: I testi corrispondenti a parte del pattern all'interno di `()` vengono catturati.

Puoi scegliere uno o più dei seguenti processi:

*   **Codifica/Decodifica URL**: Applica la [codifica percentuale](https://en.wikipedia.org/wiki/Percent-encoding) o la decodifica a un gruppo di cattura. Ad esempio, se codifichi `https://example.com/hello`, viene convertito in `https%3A%2F%2Fexample.com%2Fhello`. La decodifica funziona in modo opposto.
*   **Codifica/Decodifica Base64**: Decodifica/codifica un testo in [Base64](https://en.wikipedia.org/wiki/Base64). Ad esempio, puoi codificare `hello` in `aGVsbG8=`, e decodificarlo di nuovo in `hello`.
*   **Sostituisci occorrenze**: Sostituisce uno o più caratteri in un gruppo, corrispondenti a un **Target**, con una **Sostituzione**. Ad esempio, se il *Gruppo* è `hello` e il *Target* è `l` e la Sostituzione è `y`, viene modificato in `heyyo`.

> [!NOTE]
> Questo serve per elaborare ogni gruppo di cattura e non influisce sugli URL esclusi da [Pattern URL esclusi](#excluded-url-patterns). Ad esempio, supponiamo che tu abbia questa regola:
>
> *   **Reindirizza da**: `https://example.com/(hello.*)`
> *   **Elaborazione gruppo di cattura**:
>     *   Gruppo: `$1`
>     *   Target: `.*` (Espressione regolare)
>     *   Sostituzione: `hello`
> *   **Pattern URL escluso**: `https://example.com/hello`
>
> In questo caso, `https://example.com/hello_world` non sarà escluso mentre `https://example.com/hello` sarà escluso.

### Pattern URL esclusi

![Tipi supportati: Originale](https://img.shields.io/badge/Types-Original-blue)

L'opzione **Pattern URL esclusi** consente di specificare gli URL che non vengono reindirizzati. Questo può essere utile per evitare loop di reindirizzamento o per escludere alcune parti di un sito web dal reindirizzamento.

È possibile specificare i pattern URL esclusi utilizzando i tipi di pattern Espressione regolare o Wildcard.

### Esempi

L'opzione **Esempi** consente di testare la regola di reindirizzamento fornendo URL di esempio. Aggiungendo un URL di esempio, puoi verificare se la regola funziona come previsto prima di applicarla effettivamente.

### Commenti

L'opzione **Commenti** consente di aggiungere note o commenti sulla regola di reindirizzamento. Questo può essere utile per tenere traccia del motivo per cui hai creato una regola specifica o per fornire contesto ad altri che potrebbero visualizzare le tue regole.

## Pattern URL

Ci sono 3 opzioni in cui puoi specificare uno o più pattern URL. *Reindirizza da*, *Pattern URL esclusi* e *Elaborazione gruppo di cattura*. Per specificarli, puoi scegliere tra **Wildcard** o **Espressione regolare**.

### Wildcard

**Wildcard** è un tipo di pattern più semplice che consente di utilizzare `*` (corrisponde a qualsiasi cosa) e `?` (corrisponde a qualsiasi singolo carattere) come caratteri jolly. Ecco alcuni esempi:

*   Per corrispondere a `https://example.com/hello`, puoi usare `https://example.com/*`. Questo corrisponderà a qualsiasi stringa dopo `https://example.com/`.
*   Per corrispondere a `https://example.com/search?q=hello`, puoi usare `https://example.com/search?q=*`. Questo corrisponderà a qualsiasi valore per il parametro `q`.
*   Per corrispondere a qualsiasi URL che contiene la parola `blog`, puoi usare `*blog*`.

Puoi anche usare la sostituzione in Wildcard, il che significa che puoi fare riferimento a porzioni dell'URL corrispondente usando `$1`, `$2`, ecc. Ad esempio, se usi `https://example.com/*-world-*` e l'URL è `https://example.com/hello-world-goodbye`, allora `$1` sarebbe "hello" e `$2` sarebbe "goodbye". `$0` è anche disponibile per fare riferimento all'intero URL corrispondente.

> [!Note]
> Sebbene la sostituzione sia una caratteristica delle Espressioni regolari, puoi usarla anche per Wildcard perché Redirect Web converte internamente Wildcard in Espressioni regolari.

### Espressione regolare

Le **Espressioni regolari** (Regex) sono uno strumento potente per la corrispondenza di pattern nel testo, basato sul motore di espressioni regolari di Apple descritto [qui](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042). Consentono di definire un pattern specifico che corrisponde a un insieme di stringhe. Ecco alcuni esempi.

*   Per corrispondere a `https://example.com/hello`, puoi usare `https://example.com/(.*)`. Questo corrisponderà a qualsiasi stringa dopo `https://example.com/` e la memorizzerà in un gruppo di cattura.
*   Per corrispondere a `https://example.com/search?q=hello`, puoi usare `https://example.com/search\?q=(.*)`. Questo corrisponderà al valore del parametro `q` e lo memorizzerà in un gruppo di cattura.
*   Per corrispondere a qualsiasi URL che contiene la parola `blog`, puoi usare `.*blog.*`.

Puoi fare riferimento ai gruppi di cattura in *Reindirizza a* o *Sostituzione* usando `$1`, `$2`, ... o `$0` per fare riferimento all'intera corrispondenza.

Maggiori informazioni sulla sintassi delle espressioni regolari possono essere trovate in risorse come [RegExr](https://regexr.com/).
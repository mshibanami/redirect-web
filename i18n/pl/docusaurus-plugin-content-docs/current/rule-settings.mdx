# Ustawienia reguł

Ta strona zawiera szczegółowe informacje o każdym ustawieniu na ekranie Edytuj regułę w aplikacji Redirect Web.

## Opcje

### Typ

Określ opcję **Typ**, aby kontrolować sposób obsługi przekierowania przez aplikację. Możesz wybrać spośród następujących:

*   **Oryginalny** (domyślny)
    *   Wykorzystuje tradycyjne API internetowe do kontrolowania przekierowania. Dodatkowo, używa [API Tabs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) jako mechanizmu awaryjnego.
        *   W Firefoksie do obsługi przekierowań używa [API WebRequest](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest).
    *   Możesz używać wszystkich opcji poza [Typami zasobów](#resource-types) i [Metodami żądań](#request-methods).
    *   Jest wolniejszy niż typ *Declarative* i może powodować dodatkowe żądania sieciowe.
*   **DNR** (Eksperymentalny dla Safari):
    *   Ten typ działa znacznie szybciej niż typ Oryginalny, ponieważ nie inicjuje żądania sieciowego dla źródłowego adresu URL.
    *   Pozwala określić [Typy zasobów](#resource-types) i [Metody żądań](#request-methods).
    *   ⚠️ Niektórych opcji, takich jak [Przetwarzanie grup przechwytujących](#capturing-group-processing) i [Wykluczone wzorce URL](#excluded-url-patterns), nie można używać, ponieważ nie są jeszcze obsługiwane przez API DNR.
    *   ⚠️ W Safari obecnie nie możesz umieszczać znaków pionowej kreski (`|`) w wzorcu wyrażeń regularnych. [Szczegóły](https://github.com/mshibanami/redirect-web/issues/44)
    *   ⚠️ Ponieważ API DNR w Safari wciąż ma pewne problemy, uważamy, że jest to nadal funkcja eksperymentalna dla Safari. Listę wszystkich znanych problemów znajdziesz [tutaj](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Przekieruj z

Opcja **Przekieruj z** pozwala określić wzorzec URL stron internetowych, z których chcesz przekierować. Możesz wybrać [Wildcard](#wildcard) lub [Wyrażenie regularne](#regular-expression).

Na przykład, jeśli określisz `https://example.com/*` z Wildcard, będzie to pasować do `https://example.com/` lub `https://example.com/hello`.

> [!NOTE]
> W opcji Przekieruj do możesz odwołać się do całego dopasowania za pomocą `$0` lub częściowych dopasowań za pomocą `$1`, `$2`, ... Sprawdź szczegóły w [Wzorcu URL](#url-pattern) na tej stronie.

#### Typy zasobów

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

Opcja **Typy zasobów** pozwala określić kategorie żądań internetowych, takie jak obrazy, skrypty JavaScript i arkusze stylów, do których ma zastosowanie reguła.
Na przykład, jeśli ustawisz `script`, możesz przekierować pliki JavaScript ładowane przez strony internetowe.

Obecnie dostępne są:
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

Ustawieniem domyślnym jest `main_frame`, czyli strona najwyższego poziomu ładowana do karty.

Sprawdź szczegóły każdego typu zasobu w [mdn web docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType).

#### Metody żądań

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

Opcja **Metody żądań** pozwala ustawić docelowe metody HTTP dla źródłowego adresu URL.

Wszystkie metody są ustawione domyślnie.

Sprawdź szczegóły każdej metody w [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> W Safari ta opcja może być niedostępna, ponieważ implementacja firmy Apple dla typu DNR wydaje się jej obecnie nie obsługiwać. Wysyłaliśmy do Apple informację zwrotną jako FB14502272.

#### Przeglądarki docelowe

![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Opcja **Przeglądarki docelowe** pozwala określić, do której przeglądarki reguła powinna lub nie powinna być stosowana.

*   Istnieją 2 typy przeglądarek, które możesz wybrać:
    *   **Przeglądarki, które możesz wybrać domyślnie**: Domyślnie możesz wybrać Safari, Chrome, Firefox, Edge, Opera, Arc, Brave i Vivaldi. Nie różnicuje to wariantów tej samej przeglądarki, takich jak Safari i Safari Technology Preview.
    *   **Przeglądarki określone przez użytkownika**: Po stuknięciu przycisku Dodaj w wyskakującym okienku możesz wybrać dowolną przeglądarkę inną niż Safari lub Safari Technology Preview, w której zainstalowano rozszerzenie Redirect Web.
*   Pole wyboru **Wszystkie z wyjątkiem wybranych** pozwala określić docelowo wszystkie przeglądarki oprócz tych, które wybrałeś.

> [!WARNING]
> Redirect Web nie potrafi rozróżnić, czy przeglądarką jest **Safari** czy **Safari Technology Preview**, ponieważ aplikacja sprawdza proces nadrzędny rozszerzenia, aby to wykryć, ale te dwie przeglądarki współdzielą ten sam proces nadrzędny (`/sbin/launchd`).

### Przekieruj do

Opcja **Przekieruj do** określa docelowy adres URL, na który chcesz przekierować ze źródłowego adresu URL dopasowanego opcją *Przekieruj z*. Możesz również podstawić grupy przechwytujące za pomocą `$1`, `$2`, ... lub całe dopasowanie za pomocą `$0`. Pomaga to dynamicznie określić cel. Sprawdź szczegóły w [Wzorcu URL](#url-pattern) na tej stronie.

Na przykład, jeśli ustawisz następującą regułę:

*   **Przekieruj z**: `https://google.com/*` (Wildcard)
*   **Przekieruj do**: `https://apple.com/$1`

i pasuje ona do `https://google.com/hello`, wówczas docelowy adres URL będzie `https://apple.com/hello`.

Dodatkowo, możesz modyfikować teksty `$1`, `$2`, ... przed dokonaniem podstawień. Sprawdź sekcję [Przetwarzanie grup przechwytujących](#capturing-group-processing) dla szczegółów.

> [!TIP]
> Możesz określić niestandardowy schemat URL, aby otworzyć aplikację. Oto przykłady aplikacji obsługujących głębokie linkowanie:
>
> *   Figma: `figma://file/Your_Figma_ID`
> *   Firefox: `firefox://open-url?url=https://example.com/hello`
> *   Google Chrome: `googlechromes://example.com`
> *   Microsoft Edge: `microsoft-edge://example.com`
> *   Notion: `notion://www.notion.so/Your_Note_ID`
> *   Slack: `slack://open`

#### Aplikacja

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue) ![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Jeśli chcesz określić aplikację, w której chcesz otworzyć docelowy adres URL, użyj pola kombi **Aplikacja**. Jest to dostępne tylko na macOS.

> [!WARNING]
> Możesz otworzyć tylko aplikację, która obsługuje [App Sandbox](https://developer.apple.com/documentation/security/app_sandbox). Upewnij się również, że aplikacja obsługuje otwieranie adresu URL, który chcesz otworzyć.

### Przetwarzanie grup przechwytujących

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

Opcja **Przetwarzanie grup przechwytujących** pozwala określić sposób przetwarzania przechwyconych grup, które można podstawić w opcji *Przekieruj do* za pomocą `$1`, `$2`...

Oto, jak tworzyć grupy przechwytujące:

*   **Wildcard**: Teksty dopasowane za pomocą `*` i `?` są automatycznie przechwytywane.
*   **Wyrażenie regularne**: Teksty dopasowane do części wzorca wewnątrz `()` są przechwytywane.

Możesz wybrać jeden lub więcej z poniższych procesów:

*   **Kodowanie/dekodowanie URL**: Stosuje [kodowanie procentowe](https://en.wikipedia.org/wiki/Percent-encoding) lub dekodowanie do grupy przechwytującej. Na przykład, jeśli zakodujesz `https://example.com/hello`, zostanie to przekonwertowane na `https%3A%2F%2Fexample.com%2Fhello`. Dekodowanie działa odwrotnie.
*   **Kodowanie/dekodowanie Base64**: Dekoduje/koduje tekst w [Base64](https://en.wikipedia.org/wiki/Base64). Na przykład, możesz zakodować `hello` na `aGVsbG8=`, a następnie zdekodować z powrotem na `hello`.
*   **Zastąp wystąpienia**: Zastępuje jeden lub więcej znaków w grupie, dopasowanych przez **Cel**, za pomocą **Zastępstwa**. Na przykład, jeśli *Grupa* to `hello`, a *Cel* to `l`, a Zastępstwo to `y`, zostanie to zmodyfikowane na `heyyo`.

> [!NOTE]
> Służy to do przetwarzania każdej grupy przechwytującej i nie wpływa na to, które adresy URL są wykluczane przez [Wykluczone wzorce URL](#excluded-url-patterns). Na przykład, załóżmy, że masz taką regułę:
>
> *   **Przekieruj z**: `https://example.com/(hello.*)`
> *   **Przetwarzanie grup przechwytujących**:
>     *   Grupa: `$1`
>     *   Cel: `.*` (Wyrażenie regularne)
>     *   Zastępstwo: `hello`
> *   **Wykluczony wzorzec URL**: `https://example.com/hello`
>
> W tym przypadku `https://example.com/hello_world` nie zostanie wykluczone, natomiast `https://example.com/hello` zostanie wykluczone.

### Wykluczone wzorce URL

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

Opcja **Wykluczone wzorce URL** pozwala określić adresy URL, które nie są przekierowywane. Może to być przydatne, aby uniknąć pętli przekierowań lub wykluczyć pewne części witryny z przekierowania.

Wykluczone wzorce URL można określić, używając typów wzorców Regular Expression lub Wildcard.

### Przykłady

Opcja **Przykłady** pozwala przetestować regułę przekierowania, podając przykładowe adresy URL. Dodając przykładowy adres URL, możesz sprawdzić, czy reguła działa zgodnie z oczekiwaniami, zanim faktycznie ją zastosujesz.

### Komentarze

Opcja **Komentarze** pozwala dodawać wszelkie uwagi lub komentarze dotyczące reguły przekierowania. Może to być przydatne do śledzenia, dlaczego stworzyłeś konkretną regułę, lub do zapewnienia kontekstu dla innych, którzy mogą przeglądać twoje reguły.

## Wzorzec URL

Istnieją 3 opcje, w których możesz określić jeden lub więcej wzorców URL: *Przekieruj z*, *Wykluczone wzorce URL* i *Przetwarzanie grup przechwytujących*. Aby je określić, możesz wybrać **Wildcard** lub **Wyrażenie regularne**.

### Wildcard

**Wildcard** to prostszy typ wzorca, który pozwala używać `*` (dopasowuje cokolwiek) i `?` (dopasowuje dowolny pojedynczy znak) jako symboli wieloznacznych. Oto kilka przykładów:

*   Aby dopasować `https://example.com/hello`, możesz użyć `https://example.com/*`. Będzie to pasować do każdego ciągu znaków po `https://example.com/`.
*   Aby dopasować `https://example.com/search?q=hello`, możesz użyć `https://example.com/search?q=*`. Będzie to pasować do dowolnej wartości parametru `q`.
*   Aby dopasować dowolny adres URL zawierający słowo `blog`, możesz użyć `*blog*`.

Możesz również używać podstawień w Wildcard, co oznacza, że możesz odwoływać się do części dopasowanego adresu URL za pomocą `$1`, `$2` itd. Na przykład, jeśli użyjesz `https://example.com/*-world-*`, a adresem URL jest `https://example.com/hello-world-goodbye`, wówczas `$1` będzie "hello", a `$2` będzie "goodbye". `$0` jest również dostępne do odwoływania się do całego dopasowanego adresu URL.

> [!Note]
> Chociaż podstawienie jest cechą Wyrażeń regularnych, możesz go używać również dla Wildcard, ponieważ Redirect Web wewnętrznie konwertuje Wildcard na Wyrażenie regularne.

### Wyrażenie regularne

**Wyrażenie regularne** (Regex) to potężne narzędzie do dopasowywania wzorców w tekście, zasilane przez silnik wyrażeń regularnych firmy Apple, opisany [tutaj](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042). Pozwala zdefiniować konkretny wzorzec, który pasuje do zestawu ciągów znaków. Oto kilka przykładów.

- Aby dopasować `https://example.com/hello`, możesz użyć `https://example.com/(.*)`. Będzie to pasować do każdego ciągu znaków po `https://example.com/` i przechowywać go w grupie przechwytującej.
- Aby dopasować `https://example.com/search?q=hello`, możesz użyć `https://example.com/search\?q=(.*)`. Będzie to pasować do wartości parametru `q` i przechowywać ją w grupie przechwytującej.
- Aby dopasować dowolny adres URL zawierający słowo `blog`, możesz użyć `.*blog.*`.

Możesz odwoływać się do grup przechwytujących w *Przekieruj do* lub *Zastępstwie* za pomocą `$1`, `$2`, ... lub `$0` do odwoływania się do całego dopasowania.

Więcej informacji o składni Regex można znaleźć w zasobach takich jak [RegExr](https://regexr.com/).
# Definições da Regra

Esta página fornece informações detalhadas de cada definição no ecrã Editar Regra na aplicação Redirect Web.

## Opções

### Tipo

Especifique a opção **Tipo** para controlar como a aplicação lida com o redirecionamento. Pode escolher entre as seguintes:

*   **Original** (Predefinição)
    *   Este usa as APIs Web tradicionais para controlar o redirecionamento. Adicionalmente, usa [a API Tabs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) como alternativa.
        *   No Firefox, usa a [API WebRequest](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) para lidar com o redirecionamento.
    *   Pode usar todas as opções, exceto [Tipos de Recursos](#resource-types) e [Métodos de Pedido](#request-methods).
    *   Este é mais lento do que o tipo *Declarativo* e pode causar pedidos de rede adicionais.
*   **DNR** (Experimental para Safari):
    *   Este tipo funciona muito mais rapidamente do que o tipo Original porque não inicia um pedido de rede para o URL de origem.
    *   Isto permite-lhe especificar [Tipos de Recursos](#resource-types) e [Métodos de Pedido](#request-methods).
    *   ⚠️ Não pode usar algumas opções, como [Processamento de Grupos de Captura](#capturing-group-processing) e [Padrões de URL Excluídos](#excluded-url-patterns), uma vez que ainda não foram suportadas pela API DNR.
    *   ⚠️ No Safari, atualmente não pode incluir pipes (`|`) no seu padrão de Expressão Regular. [Detalhes](https://github.com/mshibanami/redirect-web/issues/44)
    *   ⚠️ Como a API DNR do Safari ainda tem alguns problemas, consideramos que é ainda uma funcionalidade experimental para o Safari. Pode encontrar a lista de todos os problemas conhecidos [aqui](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Redirecionar De

A opção **Redirecionar De** permite-lhe especificar um padrão de URL de páginas web das quais pretende redirecionar. Pode escolher entre [Wildcard](#wildcard) ou [Expressão Regular](#regular-expression).

Por exemplo, se especificar `https://example.com/*` com Wildcard, corresponderá a `https://example.com/` ou `https://example.com/hello`.

> [!NOTE]
> Na opção Redirecionar Para, pode referenciar a correspondência completa usando `$0` ou correspondências parciais usando `$1`, `$2`, ... Consulte os detalhes em [Padrão de URL](#url-pattern) nesta página.

#### Tipos de Recurso

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

A opção **Tipos de Recurso** permite-lhe especificar as categorias de pedidos web, como imagens, JavaScripts e folhas de estilo, às quais a regra se aplica.
Por exemplo, se definir `script`, pode redirecionar os ficheiros JavaScript carregados por páginas web.

Atualmente, estão disponíveis:
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

A definição predefinida é `main_frame`, que é a página de nível superior carregada num separador.

Consulte os detalhes de cada tipo de recurso em [mdn web docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType).

#### Métodos de Pedido

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

A opção **Métodos de Pedido** permite-lhe definir os métodos HTTP de destino do URL de origem.

Todos os métodos são definidos por predefinição.

Consulte os detalhes de cada método em [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> No Safari, esta opção poderá não estar disponível porque a implementação da Apple para o tipo DNR não parece lidar com isso atualmente. Enviámos feedback à Apple como FB14502272.

#### Navegadores de Destino

![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

A opção **Navegadores de Destino** permite-lhe especificar a que navegador a regra deve ou não ser aplicada.

*   Existem 2 tipos de navegadores que pode escolher:
    *   **Navegadores que pode escolher por predefinição**: Pode escolher Safari, Chrome, Firefox, Edge, Opera, Arc, Brave e Vivaldi por predefinição. Isto não diferencia variantes do mesmo navegador, como Safari e Safari Technology Preview.
    *   **Navegadores especificados pelo utilizador**: Ao tocar no botão Adicionar no popover, pode selecionar qualquer navegador, exceto Safari ou Safari Technology Preview, que tenha a extensão Redirect Web instalada.
*   A caixa de seleção **Todos, exceto os selecionados** permite-lhe direcionar todos os navegadores, exceto os que escolheu.

> [!WARNING]
> O Redirect Web não consegue diferenciar se o navegador é **Safari** ou **Safari Technology Preview** porque a aplicação verifica o processo principal da extensão para o detetar, mas estes dois navegadores partilham o mesmo processo principal (`/sbin/launchd`).

### Redirecionar Para

A opção **Redirecionar Para** especifica um URL de destino para o qual pretende redirecionar, a partir do URL de origem correspondente à opção *Redirecionar De*. Também pode substituir grupos de captura por `$1`, `$2`, ... ou a correspondência completa por `$0`. Estes ajudam-no a especificar dinamicamente o destino. Consulte os detalhes em [Padrão de URL](#url-pattern) nesta página.

Por exemplo, se definir a seguinte regra:

*   **Redirecionar De**: `https://google.com/*` (Wildcard)
*   **Redirecionar Para**: `https://apple.com/$1`

e corresponder a `https://google.com/hello`, então o URL de destino será `https://apple.com/hello`.

Adicionalmente, pode modificar os textos de `$1`, `$2`, ... antes de fazer as substituições. Consulte a secção [Processamento de Grupos de Captura](#capturing-group-processing) para mais detalhes.

> [!TIP]
> Pode especificar um esquema de URL personalizado para abrir uma aplicação. Estes são exemplos de aplicações que suportam deep linking:
>
> *   Figma: `figma://file/Your_Figma_ID`
> *   Firefox: `firefox://open-url?url=https://example.com/hello`
> *   Google Chrome: `googlechromes://example.com`
> *   Microsoft Edge: `microsoft-edge://example.com`
> *   Notion: `notion://www.notion.so/Your_Note_ID`
> *   Slack: `slack://open`

#### Aplicação

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue) ![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Se pretender especificar uma aplicação na qual deseja abrir o URL de destino, use a caixa de combinação **Aplicação**. Isto só está disponível no macOS.

> [!WARNING]
> Só pode abrir uma aplicação que suporte [App Sandbox](https://developer.apple.com/documentation/security/app_sandbox). Além disso, certifique-se de que a aplicação suporta a abertura do URL que pretende abrir.

### Processamento de Grupos de Captura

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

A opção **Processamento de Grupos de Captura** permite-lhe especificar como processar os grupos capturados que pode substituir na opção *Redirecionar Para* com `$1`, `$2`...

São estas as formas de fazer grupos de captura:

*   **Wildcard**: Textos correspondentes a `*` e `?` são automaticamente capturados.
*   **Expressão Regular**: Textos correspondentes a parte do padrão dentro de `()` são capturados.

Pode escolher um ou mais dos seguintes processos:

*   **Codificar/Descodificar URL**: Isto aplica [percent-encoding](https://en.wikipedia.org/wiki/Percent-encoding) ou descodificação a um grupo de captura. Por exemplo, se codificar `https://example.com/hello`, será convertido para `https%3A%2F%2Fexample.com%2Fhello`. A descodificação funciona de forma oposta.
*   **Codificar/Descodificar Base64**: Isto descodifica/codifica um texto para [Base64](https://en.wikipedia.org/wiki/Base64). Por exemplo, pode codificar `hello` para `aGVsbG8=` e descodificá-lo de volta para `hello`.
*   **Substituir Ocorrências**: Isto substitui um ou mais caracteres num grupo, correspondentes a um **Alvo**, por uma **Substituição**. Por exemplo, se o *Grupo* for `hello` e o *Alvo* for `l` e a Substituição for `y`, é modificado para `heyyo`.

> [!NOTE]
> Isto serve para processar cada grupo de captura e não afeta quais URLs são excluídos pelos [Padrões de URL Excluídos](#excluded-url-patterns). Por exemplo, digamos que tem esta regra:
>
> *   **Redirecionar De**: `https://example.com/(hello.*)`
> *   **Processamento de Grupos de Captura**:
>     *   Grupo: `$1`
>     *   Alvo: `.*` (Expressão Regular)
>     *   Substituição: `hello`
> *   **Padrão de URL Excluído**: `https://example.com/hello`
>
> Neste caso, `https://example.com/hello_world` não será excluído enquanto `https://example.com/hello` será excluído.

### Padrões de URL Excluídos

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

A opção **Padrões de URL Excluídos** permite-lhe especificar os URLs que não são redirecionados. Isto pode ser útil para evitar ciclos de redirecionamento ou para excluir certas partes de um website de serem redirecionadas.

Pode especificar padrões de URL excluídos usando tipos de padrão Expressão Regular ou Wildcard.

### Exemplos

A opção **Exemplos** permite-lhe testar a sua regra de redirecionamento fornecendo URLs de amostra. Ao adicionar um URL de amostra, pode verificar se a regra funciona como esperado antes de a aplicar efetivamente.

### Comentários

A opção **Comentários** permite-lhe adicionar quaisquer notas ou comentários sobre a sua regra de redirecionamento. Isto pode ser útil para acompanhar o motivo pelo qual criou uma regra específica ou para fornecer contexto a outros que possam ver as suas regras.

## Padrão de URL

Existem 3 opções onde pode especificar um ou mais padrões de URL. *Redirecionar De*, *Padrões de URL Excluídos* e *Processamento de Grupos de Captura*. Para os especificar, pode escolher entre **Wildcard** ou **Expressão Regular**.

### Wildcard

**Wildcard** é um tipo de padrão mais simples que lhe permite usar `*` (corresponde a qualquer coisa) e `?` (corresponde a qualquer caractere único) como wildcards. Aqui estão alguns exemplos:

*   Para corresponder a `https://example.com/hello`, pode usar `https://example.com/*`. Isto corresponderá a qualquer string após `https://example.com/`.
*   Para corresponder a `https://example.com/search?q=hello`, pode usar `https://example.com/search?q=*`. Isto corresponderá a qualquer valor para o parâmetro `q`.
*   Para corresponder a qualquer URL que contenha a palavra `blog`, pode usar `*blog*`.

Também pode usar a substituição em Wildcard, o que significa que pode referenciar partes do URL correspondente usando `$1`, `$2`, etc. Por exemplo, se usar `https://example.com/*-world-*` e o URL for `https://example.com/hello-world-goodbye`, então `$1` seria "hello" e `$2` seria "goodbye". `$0` também está disponível para referenciar o URL correspondente na totalidade.

> [!Note]
> Embora a substituição seja uma funcionalidade da Expressão Regular, também a pode usar para Wildcard porque o Redirect Web converte internamente Wildcard para Expressão Regular.

### Expressão Regular

**Expressão Regular** (Regex) é uma ferramenta poderosa para corresponder padrões em texto, alimentada pelo motor de expressões regulares da Apple, que é descrito [aqui](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042). Permite-lhe definir um padrão específico que corresponde a um conjunto de strings. Aqui estão alguns exemplos.

*   Para corresponder a `https://example.com/hello`, pode usar `https://example.com/(.*)`. Isto corresponderá a qualquer string após `https://example.com/` e armazená-la-á num grupo de captura.
*   Para corresponder a `https://example.com/search?q=hello`, pode usar `https://example.com/search\?q=(.*)`. Isto corresponderá ao valor do parâmetro `q` e armazená-lo-á num grupo de captura.
*   Para corresponder a qualquer URL que contenha a palavra `blog`, pode usar `.*blog.*`.

Pode referenciar os grupos de captura em *Redirecionar Para* ou *Substituição* usando `$1`, `$2`, ... ou `$0` para referenciar a correspondência completa.

Mais informações sobre a sintaxe de Regex podem ser encontradas em recursos como [RegExr](https://regexr.com/).
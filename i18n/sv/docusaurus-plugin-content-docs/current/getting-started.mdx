# Kom igång

Den här sidan beskriver vanliga användningsfall för att skapa regler i Redirect Web-appen.

(Du kan också lära dig mer om regelinställningarna på sidan [Regelinställningar](./rule-settings).)


## Fall 1: Öppna en annan webbplats

Anta att du är beroende av Twitter och bestämmer dig för att meditera i Insight Timer varje gång du av misstag öppnar Twitter. Låt oss skapa en regel för det!

### Steg 1. Ställ in "Omdirigera från"

Först bör du ställa in avsnittet *Omdirigera från* på skärmen *Redigera regel* i appen. Målen är URL:er som börjar med `https://twitter.com/`.

I det här fallet kan du ange följande mönster med läget [Wildcard](rule-settings?id=wildcard):

```
https://twitter.com/*
```

I Wildcard-läget betyder `*` att det matchar vad som helst (= noll eller fler tecken).

Men vänta. `twitter.com` bytte namn till `x.com`. Du kan enkelt ersätta `twitter.com` med `x.com` men ingen vet när den nya ägaren kommer att ändra sig igen och rulla tillbaka det. Därför låter vi oss sikta på både `twitter.com` och `x.com`.

För att göra det, byt från Wildcard till [Reguljära uttryck](rule-settings?id=regular-expression), och ställ in detta som mönster:

```
https://(twitter|x).com/.*
```

* `(twitter|x)`: det riktar sig mot både `twitter` och `x`. (`|` kallas för *en pipe*.)
* `.*`: Det är samma som Wildcard-tecknet `*`. Mer specifikt betyder `.` *valfritt tecken* och `*` betyder *allt före denna symbol upprepat valfritt antal gånger*, vilket resulterar i att det matchar vad som helst.

Reguljära uttryck är lite komplicerade, men när du väl vant dig vid dem blir de ett kraftfullt verktyg. Vi rekommenderar att du använder [RegExr](https://regexr.com) som en lekplats för att analysera hur ditt mönster för reguljära uttryck fungerar.

> [!NOTE]
> I reguljära uttryck behandlas `.` i `(twitter|x).com` också som *valfritt tecken*. Därför matchar `(twitter|x).com/.*` också, till exempel, `twitter1com/` eller `x_com/`.
>
> För att undvika det kan du ändra det till `(twitter|x)\.com/.*`. `\` används för att escape:a ett specialtecken.
>
> Det finns dock inga sådana URL:er i den allmänna internetmiljön. Därför kan du lämna `.` som ett specialtecken om du föredrar det. Din regel är för eget bruk, så implementera den som du finner lämpligt.

### Steg 2: Ställ in "Omdirigera till"

Ange helt enkelt URL:en enligt följande:

```
https://insighttimer.com/saraauster/guided-meditations/calm
```

Nu tar Redirect Web dig till meditationen när du besöker Twitter!

**[⬇️ Ladda ner regeln](/rules/reduce-twitter-addiction.redirectweb)**

## Fall 2: Ta bort frågeparametrar från URL

Anta att det finns en frågeparameter `source=twitter` i en URL på `example.com`, och du bestämde dig för att ta bort den för att anonymisera dig själv.

I det här fallet är alternativet **Bearbetning av infångningsgrupp** det enklaste sättet:

* **Omdirigera från**: `https://example.com/*` (Wildcard)
* **Omdirigera till**: `$0`
* **Bearbetning av infångningsgrupp**:
    * **Grupp**: `$0`
    * **Process**: Ersätt förekomster
        * **Mål**: `&?source=[^&]*`
        * **Ersättning**: *(ingen)*
        * **Textmönster**: Reguljärt uttryck

**[⬇️ Ladda ner regeln](/rules/remove-parameters.redirectweb)**

Denna regel fungerar enligt följande:

```
https://example.com/?source=twitter
↪ https://example.com/?

https://example.com/?hello=world&source=twitter&foo=bar
↪ https://example.com/?hello=world&foo=bar
```

Om du vill ta bort fler parametrar, lägg till fler processer.

## Fall 3: Lägg till frågeparametrar till URL

Låt oss säga att det finns en webbplats som heter `example.com` som visar en mobil layout som standard, men du föredrar deras skrivbordslayout. Lyckligtvis stöder webbplatsen en frågeparameter `layout` för att ange vilken layout webbplatsen ska visa. Låt oss skapa en regel som automatiskt lägger till `layout=desktop`.

Kanske tror du att du kan definiera det på följande sätt:

* **Omdirigera från**: `https://example.com/.*` (Reguljärt uttryck)
* **Omdirigera till**: `$0?layout=desktop`

`$0` refererar till mål-URL:en. Om du försöker komma åt `example.com/hello` omdirigeras du till `example.com/hello?layout=desktop`. Denna funktion kallas *substitution*.

> [!TIP]
> Substitution är också tillgängligt för Wildcard-läget eftersom det internt konverteras till ett reguljärt uttryck.

Det finns dock några problem med dessa inställningar.

### Problem 1: Oändlig loop

Den nuvarande inställningen skapar en oändlig omdirigeringsloop eftersom `https://example.com/.*` också riktar sig mot `https://example.com/hello?layout=desktop`.

I det här fallet kan du ange ett exkluderat URL-mönster som låter dig komma åt utan omdirigering, så här med reguljärt uttryck:

```
.*[&?]layout=[^&]*.*
```

* `.*`: Matchar vad som helst
* `[&?]`: Matchar antingen `&` eller `?`
* `[^&]*`: Matchar vad som helst utom `&`

### Problem 2: Kan inte hantera befintliga parametrar korrekt

Om mål-URL:en redan har andra frågeparametrar som `example.com/hello?theme=dark`, kommer destinationen att vara `example.com/hello?theme=dark?layout=desktop` (det finns två `?` i URL:en) men du kan bara sammanfoga parametrarna med `&`. `?` som specialtecken är endast tillåtet i början av parametrarna. Så det behandlas inte som en giltig parameter.

I det här fallet ändrar du inställningarna så här:

* **Omdirigera från**: `(https://example.com/[^?]*)(\?(.*))?`
* **Omdirigera till**: `$1?layout=desktop&$3`

Låt oss titta steg för steg.

* `(https://example.com/[^?]*)`: Matchar delen fram till föregående tecken för `?`.
    * `[^?]*` matchar vad som helst utom `?`.
    * Detta är inslaget i `()` så att du kan referera till det med `$1` senare.
* `(\?(.*))?`: Matchar en sträng som börjar med `?`, vilket betyder frågeparametrar.
    * Detta matchar också en tom sträng med `?`-kvantifieraren i slutet av mönstret, vilket *matchar noll eller en gång*.
    * Den yttre `()` och den inre `()` kan refereras med `$2` respektive `$3` senare.

[RegExr](https://regexr.com) kan hjälpa dig att förstå detaljerna.

> [!NOTE]
> RegExr visar ett fel när du inte escape:ar `/` med `\`. Även om du kan escape:a det, krävs det inte eftersom Redirect Web använder en annan motor från Apple som inte kräver escape.

Detta är inte en perfekt lösning, eftersom den omdirigerar `example.com/hello` till `example.com/hello?layout=desktop&`, vilket inkluderar ett onödigt `&` i slutet av URL:en. Det är inget större problem i allmänhet, men om du vill ta bort det kan du använda *Bearbetning av infångningsgrupp*.

Sammanfattningsvis är detta det slutliga resultatet:

* **Omdirigera från**: `(https://example.com/[^?]*)((\?(.*))?)` (Reguljärt uttryck)
* **Omdirigera till**: `$1?layout=desktop$3`
* **Exkluderat URL-mönster**: `.*[&?]layout=[^&]*.*` (Reguljärt uttryck)
* **Bearbetning av infångningsgrupp**:
    * **Grupp**: `$3`
    * **Process**: Ersätt förekomster
        * **Mål**: `\?(.*)`
        * **Ersättning**: `&$1`

**[⬇️ Ladda ner regeln](/rules/add-parameters.redirectweb)**

Detta är endast ett exempel. Du kan också skapa flera regler för att hantera varje problem. Det kan vara mycket enklare.
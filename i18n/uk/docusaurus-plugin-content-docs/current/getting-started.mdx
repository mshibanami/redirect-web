# Початок роботи

Ця сторінка описує поширені випадки використання для створення правил у веб-додатку Redirect.

(Ви також можете дізнатися деталі налаштувань правил на сторінці [Налаштування правил](./rule-settings).)

## Випадок 1: Відкриття іншого веб-сайту

Припустимо, ви залежні від Twitter і вирішили медитувати в Insight Timer щоразу, коли випадково відкриваєте Twitter. Створимо правило для цього!

### Крок 1. Налаштуйте "Перенаправити з" (Redirect From)

Спочатку ви повинні налаштувати розділ *Redirect From* на екрані *Edit Rule* у додатку. Ціллю є URL-адреси, що починаються з `https://twitter.com/`.

У цьому випадку ви можете вказати наступний шаблон у режимі [Wildcard](rule-settings?id=wildcard):

```
https://twitter.com/*
```

У режимі Wildcard, `*` означає, що він збігається з чим завгодно (= нуль або більше символів).

Однак, зачекайте. `twitter.com` було перейменовано на `x.com`. Ви можете просто замінити `twitter.com` на `x.com`, але ніхто не знає, коли новий власник знову передумає і поверне його назад. Тому, давайте націлимося як на `twitter.com`, так і на `x.com`.

Для цього перейдіть з Wildcard на [Regular Expression](rule-settings?id=regular-expression) і встановіть цей шаблон:

```
https://(twitter|x).com/.*
```

* `(twitter|x)`: він націлений як на `twitter`, так і на `x`. (`|` називається *вертикальною рискою*.)
* `.*`: Це те саме, що `*` у Wildcard. Точніше, `.` означає *будь-який символ*, а `*` означає *будь-що перед цим символом, повторене будь-яку кількість разів*, в результаті чого воно відповідає будь-чому.

Регулярні вирази трохи складні, але як тільки ви звикнете до них, вони стануть потужним інструментом. Ми рекомендуємо використовувати [RegExr](https://regexr.com) як майданчик для аналізу того, як працює ваш шаблон регулярного виразу.

> [!NOTE]
> У регулярних виразах `.` у `(twitter|x).com` також трактується як *будь-який символ*. Тому `(twitter|x).com/.*` також відповідає, наприклад, `twitter1com/` або `x_com/`.
>
> Щоб уникнути цього, ви можете змінити його на `(twitter|x)\.com/.*`. `\` використовується для екранування спеціального символу.
>
> Однак таких URL-адрес у загальному інтернет-середовищі не існує. Тому ви можете залишити `.` як спеціальний символ, якщо бажаєте. Ваше правило призначене для вашого власного використання, тому реалізуйте його на свій розсуд.

### Крок 2: Налаштуйте "Перенаправити на" (Redirect To)

Просто вкажіть URL-адресу таким чином:

```
https://insighttimer.com/saraauster/guided-meditations/calm
```

Тепер Redirect Web переносить вас до медитації, коли ви заходите в Twitter!

**[⬇️ Завантажити Правило](/rules/reduce-twitter-addiction.redirectweb)**

## Випадок 2: Видалення параметрів запиту з URL-адреси

Припустимо, в URL-адресі `example.com` є параметр запиту `source=twitter`, і ви вирішили видалити його, щоб анонімізуватися.

У цьому випадку найпростішим способом є опція **Обробка груп захоплення (Capturing Group Processing)**:

* **Redirect From**: `https://example.com/*` (Wildcard)
* **Redirect To**: `$0`
* **Capturing Group Processing**:
    * **Group**: `$0`
    * **Process**: Replace Occurrences
        * **Target**: `&?source=[^&]*`
        * **Replacement**: *(немає)*
        * **Text Pattern**: Regular Expression

**[⬇️ Завантажити Правило](/rules/remove-parameters.redirectweb)**

Це правило працює наступним чином:

```
https://example.com/?source=twitter
↪ https://example.com/?

https://example.com/?hello=world&source=twitter&foo=bar
↪ https://example.com/?hello=world&foo=bar
```

Якщо ви хочете видалити більше параметрів, додайте більше процесів.

## Випадок 3: Додавання параметрів запиту до URL-адреси

Припустимо, існує веб-сайт `example.com`, який за замовчуванням відображає мобільний макет, але ви віддаєте перевагу його настільному макету. На щастя, веб-сайт підтримує параметр запиту `layout` для вказівки макета, який відображає веб-сайт. Створимо правило, яке автоматично додає `layout=desktop`.

Можливо, ви думаєте, що можете визначити це наступним чином:

* **Redirect From**: `https://example.com/.*` (Regular Expression)
* **Redirect To**: `$0?layout=desktop`

`$0` посилається на цільову URL-адресу. Якщо ви спробуєте отримати доступ до `example.com/hello`, вас перенаправить на `example.com/hello?layout=desktop`. Ця функція називається *підстановкою*.

> [!TIP]
> Підстановка також доступна для режиму Wildcard, оскільки він внутрішньо перетворюється на регулярний вираз.

Однак, існують деякі проблеми з цими налаштуваннями.

### Проблема 1: Нескінченний цикл

Поточне налаштування створює нескінченний цикл перенаправлень, оскільки `https://example.com/.*` також націлений на `https://example.com/hello?layout=desktop`.

У цьому випадку ви можете вказати шаблон виключеної URL-адреси, який дозволяє отримати доступ без перенаправлення, наприклад, такий з регулярним виразом:

```
.*[&?]layout=[^&]*.*
```

* `.*`: Відповідає будь-чому
* `[&?]`: Відповідає або `&`, або `?`
* `[^&]*`: Відповідає будь-чому, крім `&`

### Проблема 2: Неможливо коректно обробити існуючі параметри

Якщо цільова URL-адреса вже має інші параметри запиту, наприклад `example.com/hello?theme=dark`, пунктом призначення буде `example.com/hello?theme=dark?layout=desktop` (в URL-адресі є два `?`), але ви можете об'єднувати параметри лише за допомогою `&`. `?` як спеціальний символ дозволено лише на початку параметрів. Тому він не розглядається як дійсний параметр.

У цьому випадку змініть налаштування так:

* **Redirect From**: `(https://example.com/[^?]*)(\?(.*))?`
* **Redirect To**: `$1?layout=desktop&$3`

Розглянемо покроково.

* `(https://example.com/[^?]*)`: Збігається з частиною до попереднього символу `?`.
    * `[^?]*` збігається з будь-чим, крім `?`.
    * Це обгорнуто в `()`, щоб ви могли посилатися на це за допомогою `$1` пізніше.
* `(\?(.*))?`: Збігається з рядком, що починається з `?`, що означає параметри запиту.
    * Це також збігається з порожнім рядком за допомогою квантифікатора `?` в кінці шаблону, який *збігається нуль або один раз*.
    * Зовнішні `()` та внутрішні `()` можуть посилатися на `$2` та `$3` відповідно пізніше.

[RegExr](https://regexr.com) може допомогти вам зрозуміти деталі.

> [!NOTE]
> RegExr показує помилку, якщо ви не екрануєте `/` за допомогою `\`. Хоча ви можете екранувати його, це не є обов'язковим, оскільки Redirect Web використовує інший рушій від Apple, який не вимагає екранування.

Це не ідеальне рішення, оскільки воно перенаправляє `example.com/hello` на `example.com/hello?layout=desktop&`, що включає зайвий `&` в кінці URL-адреси. Загалом, це не є великою проблемою, але якщо ви хочете видалити його, ви можете використовувати *Обробку груп захоплення*.

На закінчення, ось остаточний результат:

* **Redirect From**: `(https://example.com/[^?]*)((\?(.*))?)` (Regular Expression)
* **Redirect To**: `$1?layout=desktop$3`
* **Excluded URL Pattern**: `.*[&?]layout=[^&]*.*` (Regular Expression)
* **Capturing Group Processing**:
    * **Group**: `$3`
    * **Process**: Replace Occurrences
        * **Target**: `\?(.*)`
        * **Replacement**: `&$1`

**[⬇️ Завантажити Правило](/rules/add-parameters.redirectweb)**

Це лише приклад. Ви також можете створити кілька правил для вирішення кожної проблеми. Це може бути набагато простіше.

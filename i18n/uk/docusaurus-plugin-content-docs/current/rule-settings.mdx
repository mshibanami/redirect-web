# Налаштування правил

Ця сторінка містить детальну інформацію про кожне налаштування на екрані редагування правила в застосунку Redirect Web.

## Параметри

### Тип

Вкажіть опцію **Тип**, щоб контролювати, як застосунок обробляє переспрямування. Ви можете вибрати з наступних:

*   **Оригінальний** (За замовчуванням)
    *   Цей тип використовує традиційні веб-API для керування переспрямуванням. Додатково він використовує [Tabs API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) як запасний варіант.
        *   У Firefox він використовує [WebRequest API](https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) для обробки переспрямування.
    *   Ви можете використовувати всі параметри, окрім [Типів ресурсів](#resource-types) та [Методів запиту](#request-methods).
    *   Це повільніше, ніж тип *Декларативний*, і може спричинити додаткові мережеві запити.
*   **DNR** (Експериментально для Safari):
    *   Цей тип працює значно швидше, ніж тип Original, оскільки він не ініціює мережевий запит для вихідної URL-адреси.
    *   Це дозволяє вказувати [Типи ресурсів](#resource-types) та [Методи запиту](#request-methods).
    *   ⚠️ Ви не можете використовувати деякі параметри, такі як [Обробка груп захоплення](#capturing-group-processing) та [Шаблони виключених URL-адрес](#excluded-url-patterns), оскільки вони ще не підтримуються DNR API.
    *   ⚠️ У Safari наразі ви не можете включати символи вертикальної риски (`|`) у свій шаблон регулярного виразу. [Деталі](https://github.com/mshibanami/redirect-web/issues/44)
    *   ⚠️ Оскільки DNR API Safari все ще має деякі проблеми, ми вважаємо це експериментальною функцією для Safari. Ви можете знайти список усіх відомих проблем [тут](https://github.com/mshibanami/redirect-web/issues?q=state%3Aopen%20label%3ADNR%20label%3ASafari).

### Переспрямувати з

Параметр **Переспрямувати з** дозволяє вказати шаблон URL-адрес веб-сторінок, з яких ви бажаєте переспрямовувати. Ви можете обрати [Wildcard](#wildcard) або [Регулярний вираз](#regular-expression).

Наприклад, якщо ви вкажете `https://example.com/*` за допомогою Wildcard, він буде відповідати `https://example.com/` або `https://example.com/hello`.

> [!NOTE]
> У параметрі Redirect To ви можете посилатися на весь збіг за допомогою `$0` або на часткові збіги за допомогою `$1`, `$2`, ... Деталі дивіться в розділі [Шаблон URL-адреси](#url-pattern) на цій сторінці.

#### Типи ресурсів

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

Параметр **Типи ресурсів** дозволяє вказувати категорії веб-запитів, таких як зображення, JavaScript-файли та таблиці стилів, до яких застосовується правило.
Наприклад, якщо ви встановите `script`, ви можете переспрямовувати JavaScript-файли, завантажені веб-сторінками.

Наразі доступні такі:
`main_frame`, `sub_frame`, `stylesheet`, `script`, `image`, `font`, `xmlhttprequest`, `ping`, `media`, `websocket`, `other`

Налаштування за замовчуванням — `main_frame`, що є сторінкою верхнього рівня, завантаженою на вкладку.

Будь ласка, перегляньте деталі кожного типу ресурсу в [mdn web docs](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/declarativeNetRequest/ResourceType).

#### Методи запиту

![Supported Types: DNR](https://img.shields.io/badge/Types-DNR-blue)

Параметр **Методи запиту** дозволяє встановити цільові HTTP-методи вихідної URL-адреси.

За замовчуванням встановлені всі методи.

Будь ласка, перегляньте деталі кожного методу в [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods).

> [!WARNING]
> У Safari цей параметр може бути недоступний, оскільки реалізація типу DNR від Apple, схоже, наразі не підтримує його. Ми надіслали відгук до Apple як FB14502272.

#### Цільові браузери

![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Параметр **Цільові браузери** дозволяє вказати, до яких браузерів правило має або не має застосовуватися.

*   Є 2 типи браузерів, які ви можете вибрати:
    *   **Браузери, які можна вибрати за замовчуванням**: За замовчуванням ви можете вибрати Safari, Chrome, Firefox, Edge, Opera, Arc, Brave та Vivaldi. Це не розрізняє варіанти одного й того ж браузера, наприклад Safari та Safari Technology Preview.
    *   **Браузери, визначені користувачем**: Натиснувши кнопку Додати на спливаючому вікні, ви можете вибрати будь-який браузер, окрім Safari або Safari Technology Preview, який має встановлене розширення Redirect Web.
*   Прапорець **Усі, окрім вибраних** дозволяє вам націлюватися на всі браузери, крім тих, які ви обрали.

> [!WARNING]
> Redirect Web не може розрізнити, чи є браузер **Safari** або **Safari Technology Preview**, оскільки застосунок перевіряє батьківський процес розширення для його виявлення, але ці два браузери використовують один і той самий батьківський процес (`/sbin/launchd`).

### Переспрямувати до

Параметр **Переспрямувати до** вказує цільову URL-адресу, на яку ви бажаєте переспрямувати з вихідної URL-адреси, що збіглася з параметром *Переспрямувати з*. Ви також можете замінити групи захоплення на `$1`, `$2`, ... або весь збіг на `$0`. Це допомагає динамічно вказувати призначення. Деталі дивіться в розділі [Шаблон URL-адреси](#url-pattern) на цій сторінці.

Наприклад, якщо ви встановите наступне правило:

*   **Переспрямувати з**: `https://google.com/*` (Wildcard)
*   **Переспрямувати до**: `https://apple.com/$1`

і воно збігається з `https://google.com/hello`, тоді цільова URL-адреса буде `https://apple.com/hello`.

Крім того, ви можете змінювати тексти `$1`, `$2`, ... перед виконанням замін. Деталі дивіться в розділі [Обробка груп захоплення](#capturing-group-processing).

> [!TIP]
> Ви можете вказати власну схему URL-адреси для відкриття застосунку. Ось приклади застосунків, що підтримують deep linking:
>
> *   Figma: `figma://file/Your_Figma_ID`
> *   Firefox: `firefox://open-url?url=https://example.com/hello`
> *   Google Chrome: `googlechromes://example.com`
> *   Microsoft Edge: `microsoft-edge://example.com`
> *   Notion: `notion://www.notion.so/Your_Note_ID`
> *   Slack: `slack://open`

#### Застосунок

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue) ![Supported Platforms: macOS](https://img.shields.io/badge/Platforms-macOS-white)

Якщо ви хочете вказати застосунок, яким потрібно відкрити цільову URL-адресу, використовуйте комбіноване поле **Застосунок**. Це доступно лише на macOS.

> [!WARNING]
> Ви можете відкривати лише застосунки, які підтримують [App Sandbox](https://developer.apple.com/documentation/security/app_sandbox). Також переконайтеся, що застосунок підтримує відкриття URL-адреси, яку ви хочете відкрити.

### Обробка груп захоплення

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

Параметр **Обробка груп захоплення** дозволяє вказати, як обробляти захоплені групи, які ви можете підставляти в опції *Переспрямувати до* за допомогою `$1`, `$2`...

Ось як створюються групи захоплення:

*   **Wildcard**: Тексти, що збігаються з `*` та `?`, автоматично захоплюються.
*   **Регулярний вираз**: Тексти, що збігаються з частиною шаблону всередині `()`, захоплюються.

Ви можете вибрати один або кілька з наступних процесів:

*   **Кодування/Декодування URL**: Це застосовує [відсоткове кодування](https://en.wikipedia.org/wiki/Percent-encoding) або декодування до групи захоплення. Наприклад, якщо ви кодуєте `https://example.com/hello`, воно перетворюється на `https%3A%2F%2Fexample.com%2Fhello`. Декодування працює у зворотному напрямку.
*   **Кодування/Декодування Base64**: Це декодує/кодує текст у [Base64](https://en.wikipedia.org/wiki/Base64). Наприклад, ви можете закодувати `hello` в `aGVsbG8=`, а потім декодувати назад у `hello`.
*   **Замінити входження**: Це замінює один або кілька символів у групі, що збігається з **Ціллю**, на **Заміну**. Наприклад, якщо *Група* — `hello`, а *Ціль* — `l`, а Заміна — `y`, вона модифікується на `heyyo`.

> [!NOTE]
> Це призначено для обробки кожної групи захоплення і не впливає на те, які URL-адреси виключаються за допомогою [Шаблонів виключених URL-адрес](#excluded-url-patterns). Наприклад, припустимо, у вас є таке правило:
>
> *   **Переспрямувати з**: `https://example.com/(hello.*)`
> *   **Обробка груп захоплення**:
>     *   Група: `$1`
>     *   Ціль: `.*` (Регулярний вираз)
>     *   Заміна: `hello`
> *   **Виключений шаблон URL**: `https://example.com/hello`
>
> У цьому випадку `https://example.com/hello_world` не буде виключено, тоді як `https://example.com/hello` буде виключено.

### Шаблони виключених URL-адрес

![Supported Types: Original](https://img.shields.io/badge/Types-Original-blue)

Параметр **Шаблони виключених URL-адрес** дозволяє вказати URL-адреси, які не переспрямовуються. Це може бути корисно для уникнення циклів переспрямування або для виключення певних частин веб-сайту з переспрямування.

Ви можете вказати шаблони виключених URL-адрес, використовуючи типи шаблонів Regular Expression або Wildcard.

### Приклади

Параметр **Приклади** дозволяє перевірити правило переспрямування, надаючи зразки URL-адрес. Додавши зразок URL-адреси, ви можете перевірити, чи працює правило, як очікувалося, перш ніж фактично його застосовувати.

### Коментарі

Параметр **Коментарі** дозволяє додавати будь-які нотатки або коментарі щодо вашого правила переспрямування. Це може бути корисно для відстеження того, чому ви створили певне правило, або для надання контексту іншим, хто може переглядати ваші правила.

## Шаблон URL-адреси

Є 3 параметри, де ви можете вказати один або кілька шаблонів URL-адрес: *Переспрямувати з*, *Шаблони виключених URL-адрес* та *Обробка груп захоплення*. Щоб вказати їх, ви можете вибрати **Wildcard** або **Регулярний вираз**.

### Wildcard

**Wildcard** — це простіший тип шаблону, який дозволяє використовувати `*` (відповідає будь-чому) та `?` (відповідає будь-якому одному символу) як символи-замінники. Ось кілька прикладів:

*   Щоб відповідати `https://example.com/hello`, ви можете використовувати `https://example.com/*`. Це відповідатиме будь-якому рядку після `https://example.com/`.
*   Щоб відповідати `https://example.com/search?q=hello`, ви можете використовувати `https://example.com/search?q=*`. Це відповідатиме будь-якому значенню для параметра `q`.
*   Щоб відповідати будь-якій URL-адресі, яка містить слово `blog`, ви можете використовувати `*blog*`.

Ви також можете використовувати підстановку в Wildcard, що означає, що ви можете посилатися на частини відповідної URL-адреси за допомогою `$1`, `$2` тощо. Наприклад, якщо ви використовуєте `https://example.com/*-world-*`, а URL-адреса — `https://example.com/hello-world-goodbye`, тоді `$1` буде "hello", а `$2` — "goodbye". `$0` також доступний для посилання на всю URL-адресу, що збіглася.

> [!Note]
> Хоча підстановка є функцією Regular Expression, ви також можете використовувати її для Wildcard, оскільки Redirect Web внутрішньо перетворює Wildcard на Regular Expression.

### Регулярний вираз

**Регулярний вираз** (Regex) — це потужний інструмент для зіставлення шаблонів у тексті, що працює на основі механізму регулярних виразів Apple, описаного [тут](https://developer.apple.com/documentation/foundation/nsregularexpression#1661042). Він дозволяє визначати конкретний шаблон, який відповідає набору рядків. Ось кілька прикладів.

*   Щоб відповідати `https://example.com/hello`, ви можете використовувати `https://example.com/(.*)`. Це відповідатиме будь-якому рядку після `https://example.com/` та зберігатиме його в групі захоплення.
*   Щоб відповідати `https://example.com/search?q=hello`, ви можете використовувати `https://example.com/search\?q=(.*)`. Це відповідатиме значенню параметра `q` та зберігатиме його в групі захоплення.
*   Щоб відповідати будь-якій URL-адресі, яка містить слово `blog`, ви можете використовувати `.*blog.*`.

Ви можете посилатися на групи захоплення в *Переспрямувати до* або *Заміні* за допомогою `$1`, `$2`, ... або `$0` для посилання на весь збіг.

Більше інформації про синтаксис Regex можна знайти в таких ресурсах, як [RegExr](https://regexr.com/).